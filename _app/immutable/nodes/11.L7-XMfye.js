import{r as st,a as ot,u as it,s as lt,b as ct,g as dt,c as ut}from"../chunks/BwLfPz45.js";import"../chunks/DsnmJJEf.js";import{s as he,d as Be,o as ft}from"../chunks/DGrEk6DV.js";import{aU as Z,d as z,a as h,j as U,g as a,x as S,M as j,S as Ne,c as m,r as g,t as Q,u as p,f as x,p as ze,s as b,b as Ie,ay as Fe,aV as gt}from"../chunks/Dj_qSXc_.js";import{l as $e,s as Ee,p as H,c as re,i as se,d as vt}from"../chunks/Cie8SrI_.js";import{I as Re,s as Te,D as oe,P as mt,X as pt,e as Ve}from"../chunks/CCr0WPC9.js";import{h as ht}from"../chunks/DYYehU_A.js";import{s as D,d as ie,a as He,r as St,e as _t}from"../chunks/PczVBC9G.js";import{b as me,M as bt,g as wt}from"../chunks/DCurxu3d.js";import{l as xt}from"../chunks/CyAkH-4i.js";import"../chunks/D_zn7YC-.js";import"../chunks/0F8CCDVG.js";import"../chunks/B1sSVCCJ.js";import"../chunks/YvPky1bd.js";import{s as Le}from"../chunks/cMrtn-FD.js";import"../chunks/Xc-oeaWZ.js";import{c as yt,S as Ct}from"../chunks/7QimJVlU.js";import{l as kt,s as Dt}from"../chunks/DC6y9jvH.js";import{p as Oe,a as Mt,b as zt}from"../chunks/_vGz1ruN.js";import"../chunks/DLeBafjS.js";import"../chunks/DrBvUoO-.js";function It(t,e){const n=$e(e,["children","$$slots","$$events","$$legacy"]);const s=[["path",{d:"M5 12h14"}]];Re(t,Ee({name:"minus"},()=>n,{get iconNode(){return s},children:(l,o)=>{var r=Z(),i=z(r);Te(i,e,"default",{}),h(l,r)},$$slots:{default:!0}}))}function $t(t,e){const n=$e(e,["children","$$slots","$$events","$$legacy"]);const s=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21"}]];Re(t,Ee({name:"monitor"},()=>n,{get iconNode(){return s},children:(l,o)=>{var r=Z(),i=z(r);Te(i,e,"default",{}),h(l,r)},$$slots:{default:!0}}))}function Et(t,e){const n=$e(e,["children","$$slots","$$events","$$legacy"]);const s=[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]];Re(t,Ee({name:"plus"},()=>n,{get iconNode(){return s},children:(l,o)=>{var r=Z(),i=z(r);Te(i,e,"default",{}),h(l,r)},$$slots:{default:!0}}))}function Ze(t,e){const n=$e(e,["children","$$slots","$$events","$$legacy"]);const s=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]];Re(t,Ee({name:"settings"},()=>n,{get iconNode(){return s},children:(l,o)=>{var r=Z(),i=z(r);Te(i,e,"default",{}),h(l,r)},$$slots:{default:!0}}))}function Rt(t,e){const{breakpoints:n,minScale:s,maxScale:l}=e;if(n.length===0)return pe(e.baseScaleFactor,s,l);if(t<=n[0].width)return pe(n[0].scale,s,l);const o=n[n.length-1];if(t>=o.width)return pe(o.scale,s,l);for(let r=0;r<n.length-1;r++){const i=n[r],d=n[r+1];if(t>=i.width&&t<=d.width){const c=At(t,i,d);return pe(c,s,l)}}return pe(e.baseScaleFactor,s,l)}function Tt(t,e){const{columnsBreakpoints:n,minColumns:s,maxColumns:l}=e;if(n.length===0)return s;let o=n[0].columns;for(const r of n)if(t>=r.width)o=r.columns;else break;return Math.max(s,Math.min(l,o))}function At(t,e,n){const s=n.width-e.width,l=n.scale-e.scale,o=(t-e.width)/s;return e.scale+l*o}function pe(t,e,n){return Math.max(e,Math.min(n,t))}function jt(t){let e=j(1),n=j(1920),s=j(4);function l(){const i=window.innerWidth;S(n,i,!0),S(e,Rt(i,t.scalingSettings),!0),S(s,Tt(i,t.gridSettings),!0)}let o=null;function r(){o!==null&&clearTimeout(o),o=setTimeout(()=>{l(),o=null},300)}return U(()=>{l(),window.addEventListener("resize",r);const i=t.scalingSettings.breakpoints.map(d=>{const c=window.matchMedia(`(min-width: ${d.width}px)`),f=()=>l();return c.addEventListener("change",f),{mq:c,listener:f}});return()=>{window.removeEventListener("resize",r),o!==null&&clearTimeout(o),i.forEach(({mq:d,listener:c})=>{d.removeEventListener("change",c)})}}),{get scaleFactor(){return a(e)},get viewportWidth(){return a(n)},get gridColumns(){return a(s)}}}function Pt(t){let e=j(Date.now()+t.intervalMs),n=j(Ne(t.intervalMs)),s=null;function l(){const r=Date.now(),i=a(e)-r;i<=0?(S(e,Date.now()+t.intervalMs),S(n,t.intervalMs,!0)):S(n,i)}function o(){S(e,Date.now()+t.intervalMs),S(n,t.intervalMs,!0)}return U(()=>{const r=t.intervalMs;return S(e,Date.now()+r),S(n,r,!0),s=setInterval(()=>{l()},1e3),l(),()=>{s!==null&&(clearInterval(s),s=null)}}),{get remaining(){return a(n)},restart:o}}function Ft(t){let e=j(Ne({...t.defaults})),n=j(!1);function s(){const c=kt(t.slug);c&&S(e,{...c},!0)}function l(){Dt(t.slug,a(e)),zt("sinage",a(e).theme),S(n,!1)}function o(){const c=a(e).theme;S(e,{...t.defaults},!0),t.defaults.theme!==c&&Oe("sinage",t.defaults.theme)}function r(){S(n,!0)}function i(){S(n,!1),s(),Mt("sinage")}function d(){a(n)?i():r()}return U(()=>{s()}),{get settings(){return a(e)},get isOpen(){return a(n)},updateSettings(c){const f=a(e).theme;S(e,c,!0),c.theme!==f&&Oe("sinage",c.theme)},save:l,reset:o,openDrawer:r,closeDrawer:i,toggleDrawer:d}}function Nt(t){const e=[];return(t.ctrlKey||t.metaKey)&&e.push("Ctrl"),t.altKey&&e.push("Alt"),t.shiftKey&&e.push("Shift"),t.key&&!["Control","Alt","Shift","Meta"].includes(t.key)&&e.push(t.key.toUpperCase()),e.join("+")}function We(t){if(!t||!(t instanceof HTMLElement))return!1;const e=t.tagName.toLowerCase(),n=e==="input"||e==="textarea",s=t.isContentEditable;return n||s}function Lt(t){function e(n){if(We(n.target))return;const s=Nt(n);for(const[l,o]of t.shortcuts)if(s.toUpperCase()===l.toUpperCase()){n.preventDefault(),o();return}}U(()=>(window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}))}function Gt(t,e,n){const s=n.positions.find(d=>d.cardIndex===t);if(!s)return null;const l=s.row+(s.rowSpan-1)/2,o=s.col+(s.colSpan-1)/2;let r=null,i=1/0;for(const d of n.positions){if(d.cardIndex===t)continue;const c=d.row+(d.rowSpan-1)/2,f=d.col+(d.colSpan-1)/2;let u=!1;switch(e){case"right":u=f>o;break;case"left":u=f<o;break;case"down":u=c>l;break;case"up":u=c<l;break}if(!u)continue;const v=Math.abs(c-l),_=Math.abs(f-o),y=3,K=e==="left"||e==="right"?_+v*y:v+_*y;K<i&&(i=K,r=d.cardIndex)}return r}function Ot(t){let e=j(null);U(()=>{a(e)!==null&&a(e)>=t.cardCount&&S(e,t.cardCount>0?t.cardCount-1:null,!0)});function n(r){if(a(e)===null){S(e,0);return}if(t.layoutMap){const d=Gt(a(e),r,t.layoutMap);d!==null&&S(e,d,!0);return}let i=a(e);switch(r){case"right":i=a(e)+1;break;case"left":i=a(e)-1;break;case"down":i=a(e)+t.gridColumns;break;case"up":i=a(e)-t.gridColumns;break}i>=0&&i<t.cardCount&&S(e,i,!0)}function s(){S(e,null)}function l(r){r>=0&&r<t.cardCount&&S(e,r,!0)}function o(r){if(We(r.target))return;const d={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[r.key];d&&(r.preventDefault(),n(d))}return U(()=>(window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)})),{get selectedIndex(){return a(e)},navigate:n,clearSelection:s,selectIndex:l}}const Ut=async({data:t})=>{if(!t.boardSlug)return{...t,metrics:[],graphs:[]};const e={slug:t.boardSlug,metricDefinitions:t.metricDefinitions,graphDefinitions:t.graphDefinitions},n=st(e),s=ot(e);return{...t,metrics:n,graphs:s}},Ha=Object.freeze(Object.defineProperty({__proto__:null,load:Ut},Symbol.toStringTag,{value:"Module"})),Xe={layout:{headerHeight:64,gridGap:.375,cardPadding:.75},grid:{columnsBreakpoints:[{width:0,columns:2},{width:768,columns:3},{width:1024,columns:4},{width:2560,columns:5}],autoRows:"1fr",aspectRatio:16/9,minColumns:2,maxColumns:5},scaling:{baseTextSize:1,baseScaleFactor:1,minScale:.6,maxScale:1.5,breakpoints:[{width:1280,scale:.75},{width:1920,scale:1},{width:2560,scale:1.25},{width:3840,scale:1.5}]},timer:{updateInterval:600*1e3,displayFormat:"min-sec"}},Kt={min:.8,max:1.2,step:.1},Ye=1.35,Bt={theme:"system",gridColumns:4,cardSizeScale:1},Vt={...Xe,cardLayout:{cardSpans:{}}},Ht={elevator:Vt};function Zt(t){return Ht[t]??Xe}var Wt=x('<div class="relative h-full overflow-hidden rounded-lg transition-all duration-150 svelte-joxuqx" role="gridcell" data-sinage-card=""><!></div>');function Ue(t,e){let n=H(e,"isSelected",3,!1),s=H(e,"scaleFactor",3,1),l=H(e,"colSpan",3,1),o=H(e,"rowSpan",3,1);const r=p(()=>s()*Ye),i=p(()=>s()*.75),d=p(()=>s()*4);var c=Wt();let f;var u=m(c);Le(u,()=>e.children),g(c),Q(()=>{D(c,"aria-selected",n()),f=ie(c,"",f,{"--card-scale":a(r),padding:`${a(i)??""}rem`,"border-width":`${a(d)??""}px`,"border-color":n()?"rgb(var(--color-primary-500))":"transparent","border-style":"solid","--col-span":l(),"--row-span":o(),"grid-column":`span ${l()??""}`,"grid-row":`span ${o()??""}`})}),h(t,c)}var Xt=x('<div role="timer" aria-label="現在時刻" aria-live="polite" data-sinage-clock=""><div class="cloud-layer svelte-znjgv" aria-hidden="true"><div class="cloud cloud--1 svelte-znjgv"></div> <div class="cloud cloud--2 svelte-znjgv"></div> <div class="cloud cloud--3 svelte-znjgv"></div></div> <p class="sinage-clock__time relative font-extralight tracking-tight text-white svelte-znjgv" aria-label="時刻"> </p> <div class="svelte-znjgv"></div> <p class="sinage-clock__date relative font-semibold tracking-wide text-white/85 svelte-znjgv" aria-label="日付"> </p></div>');function Yt(t,e){ze(e,!0);let n=H(e,"variant",3,"blue"),s=H(e,"scaleFactor",3,1);const l=["日","月","火","水","木","金","土"];let o=j(Ne(new Date));U(()=>{const I=setInterval(()=>{S(o,new Date,!0)},1e3);return()=>clearInterval(I)});const r=p(()=>`${String(a(o).getHours()).padStart(2,"0")}:${String(a(o).getMinutes()).padStart(2,"0")}`),i=p(()=>`${a(o).getFullYear()}年${a(o).getMonth()+1}月${a(o).getDate()}日 ${l[a(o).getDay()]}`),d=p(()=>s()*Ye);var c=Xt();let f;var u=b(m(c),2);ie(u,"",{},{"font-size":"calc(var(--card-scale, 1) * 4.25rem)","line-height":"calc(var(--card-scale, 1) * 4.75rem)"});var v=m(u,!0);g(u);var _=b(u,2);ie(_,"",{},{height:"calc(var(--card-scale, 1) * 0.5rem)"});var y=b(_,2);ie(y,"",{},{"font-size":"calc(var(--card-scale, 1) * 1.125rem)","line-height":"calc(var(--card-scale, 1) * 1.5rem)"});var K=m(y,!0);g(y),g(c),Q(()=>{He(c,1,`sinage-clock sinage-clock--${n()??""} relative flex h-full w-full flex-col items-center justify-center overflow-hidden rounded-lg`,"svelte-znjgv"),D(c,"data-variant",n()),f=ie(c,"",f,{"--card-scale":a(d),padding:"calc(var(--card-scale, 1) * 1.5rem)"}),he(v,a(r)),he(K,a(i))}),h(t,c),Ie()}var qt=x('<div class="grid h-full items-stretch" role="grid" aria-label="サイネージ指標グリッド" data-sinage-grid=""><!></div>');function Jt(t,e){ze(e,!0);let n=H(e,"scaleFactor",3,1),s=H(e,"hasMixedSpans",3,!1);const l=p(()=>e.layoutSettings.gridGap*n()),o={1:.5,2:.65,3:.8,4:1},r=p(()=>a(l)*(o[e.gridColumns]??1)),i={1:.5,2:.7,3:.85,4:.9,5:.95},d=p(()=>e.targetRows?i[Math.min(e.targetRows,5)]??1:1),c=p(()=>a(l)*a(d)),f=p(()=>e.targetRows?`repeat(${e.targetRows}, 1fr)`:void 0);var u=qt();let v;var _=m(u);Le(_,()=>e.children),g(u),Q(y=>{D(u,"data-sinage-grid-sized",e.targetRows?"":void 0),D(u,"data-scale",y),D(u,"data-columns",e.gridColumns),v=ie(u,"",v,{"--grid-gap":`${a(l)??""}rem`,"--adjusted-col-gap":`${a(r)??""}rem`,"--adjusted-row-gap":`${a(c)??""}rem`,"--card-cols":e.gridColumns,"--card-aspect":e.gridSettings.aspectRatio,"--scale-factor":n(),"grid-template-columns":`repeat(${e.gridColumns??""}, 1fr)`,"column-gap":"clamp(0.5rem, var(--adjusted-col-gap), 2.5rem)","row-gap":"clamp(0.375rem, var(--adjusted-row-gap), 2rem)","grid-template-rows":a(f),"grid-auto-rows":e.gridSettings.autoRows,"grid-auto-flow":s()?"dense":"row"})},[()=>n().toFixed(2)]),h(t,u),Ie()}var Qt=x('<div class="relative h-dvh" data-sinage-layout=""><main class="h-full overflow-auto" aria-label="メインコンテンツ"><!></main></div>');function ea(t,e){var n=Qt(),s=m(n),l=m(s);Le(l,()=>e.children),g(s),g(n),h(t,n)}var ta=x('<button type="button" role="radio"><!> <span class="capitalize"> </span></button>'),aa=x('<div class="flex items-center justify-between border-b border-surface-200 px-6 py-4 dark:border-surface-700"><div class="flex items-center gap-2"><!> <!></div> <!></div> <div class="flex min-h-0 flex-1 flex-col"><div class="flex-1 space-y-6 overflow-y-auto px-6 py-6"><div class="space-y-3"><label class="text-on-surface text-sm font-medium" for="theme-select">テーマ</label> <div class="space-y-2" role="radiogroup" aria-labelledby="theme-select"></div></div> <div class="space-y-3"><div class="flex items-center justify-between"><label for="card-size" class="text-on-surface text-sm font-medium">カードサイズ</label> <span class="text-on-surface-variant font-mono text-sm" aria-live="polite"> </span></div> <div class="flex items-center gap-3"><button type="button" class="variant-ghost-surface btn btn-sm" aria-label="カードサイズを小さくする"><!></button> <input id="card-size" type="range" class="range flex-1"/> <button type="button" class="variant-ghost-surface btn btn-sm" aria-label="カードサイズを大きくする"><!></button></div></div> <div class="rounded-container-token space-y-3 bg-surface-100 p-4 dark:bg-surface-800"><h3 class="text-on-surface text-sm font-medium">キーボードショートカット</h3> <dl class="space-y-2 text-sm"><div class="flex justify-between"><dt class="text-on-surface-variant">設定を開く</dt> <dd class="text-on-surface font-mono">Ctrl+Shift+S</dd></div> <div class="flex justify-between"><dt class="text-on-surface-variant">閉じる</dt> <dd class="text-on-surface font-mono">Esc</dd></div> <div class="flex justify-between"><dt class="text-on-surface-variant">カード選択</dt> <dd class="text-on-surface font-mono">↑ ↓ ← →</dd></div></dl></div></div> <div class="flex items-center justify-between border-t border-surface-200 px-6 py-4 dark:border-surface-700"><button type="button" class="variant-ghost-surface btn">キャンセル</button> <div class="flex gap-2"><button type="button" class="variant-ghost-surface btn">リセット</button> <button type="button" class="variant-filled-primary btn">保存</button></div></div></div>',1),na=x("<!> <!>",1);function ra(t,e){ze(e,!0);let n=p(()=>({...e.settings}));const s={light:Ct,dark:yt,system:$t},{min:l,max:o,step:r}=Kt,i=p(()=>Math.round(a(n).cardSizeScale*100)),d=["light","dark","system"];function c(v){const _={...a(n),theme:v};S(n,_),e.onSettingsChange(_)}function f(v){const _={...a(n),cardSizeScale:v};S(n,_),e.onSettingsChange(_)}function u(v){v.open||e.onCancel()}oe(t,{get open(){return e.open},onOpenChange:u,children:(v,_)=>{mt(v,{children:(y,K)=>{var I=na(),F=z(I);re(F,()=>oe.Backdrop,(ee,te)=>{te(ee,{class:"fixed inset-0 z-40 bg-black/50"})});var Se=b(F,2);re(Se,()=>oe.Positioner,(ee,te)=>{te(ee,{class:"fixed inset-0 z-50 flex justify-end",children:(_e,Ge)=>{var E=Z(),ae=z(E);re(ae,()=>oe.Content,(le,W)=>{W(le,{class:"flex h-screen w-80 flex-col bg-surface-50 shadow-xl dark:bg-surface-900",children:(Ae,be)=>{var we=aa(),ce=z(we),de=m(ce),R=m(de);Ze(R,{size:20,class:"text-on-surface","aria-hidden":"true"});var B=b(R,2);re(B,()=>oe.Title,(C,w)=>{w(C,{class:"text-on-surface text-lg font-semibold",children:(M,k)=>{Fe();var q=gt("表示設定");h(M,q)},$$slots:{default:!0}})}),g(de);var ue=b(de,2);re(ue,()=>oe.CloseTrigger,(C,w)=>{w(C,{class:"variant-ghost-surface btn btn-sm","aria-label":"設定を閉じる",children:(M,k)=>{pt(M,{size:20})},$$slots:{default:!0}})}),g(ce);var xe=b(ce,2),fe=m(xe),P=m(fe),N=b(m(P),2);Ve(N,20,()=>d,C=>C,(C,w)=>{const M=p(()=>s[w]);var k=ta();k.__click=()=>c(w);var q=m(k);re(q,()=>a(M),(O,Me)=>{Me(O,{size:18,"aria-hidden":"true"})});var De=b(q,2),J=m(De,!0);g(De),g(k),Q(()=>{He(k,1,`btn w-full justify-start ${a(n).theme===w?"variant-filled-primary":"variant-ghost-surface"}`),D(k,"aria-checked",a(n).theme===w),he(J,w==="light"?"ライト":w==="dark"?"ダーク":"システム")}),h(C,k)}),g(N),g(P);var ne=b(P,2),X=m(ne),ge=b(m(X),2),T=m(ge);g(ge),g(X);var L=b(X,2),G=m(L);G.__click=()=>f(Math.max(l,a(n).cardSizeScale-r));var je=m(G);It(je,{size:16}),g(G);var $=b(G,2);St($),$.__input=C=>f(parseFloat(C.currentTarget.value));var A=b($,2);A.__click=()=>f(Math.min(o,a(n).cardSizeScale+r));var V=m(A);Et(V,{size:16}),g(A),g(L),g(ne),Fe(2),g(fe);var Y=b(fe,2),ye=m(Y);ye.__click=function(...C){e.onCancel?.apply(this,C)};var ve=b(ye,2),Ce=m(ve);Ce.__click=function(...C){e.onReset?.apply(this,C)};var ke=b(Ce,2);ke.__click=function(...C){e.onSave?.apply(this,C)},g(ve),g(Y),g(xe),Q(()=>{he(T,`${a(i)??""}%`),G.disabled=a(n).cardSizeScale<=l,D($,"min",l),D($,"max",o),D($,"step",r),_t($,a(n).cardSizeScale),D($,"aria-valuemin",l),D($,"aria-valuemax",o),D($,"aria-valuenow",a(n).cardSizeScale),D($,"aria-valuetext",`${a(i)??""}%`),A.disabled=a(n).cardSizeScale>=o}),h(Ae,we)},$$slots:{default:!0}})}),h(_e,E)},$$slots:{default:!0}})}),h(y,I)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ie()}Be(["click","input"]);function Ke(t){if(typeof performance<"u"&&performance.mark)try{performance.mark(t)}catch(e){xt.debug(`Failed to mark performance: ${t}`,e)}}const sa={"1x1":{colSpan:1,rowSpan:1},"1x2":{colSpan:2,rowSpan:1},"2x1":{colSpan:1,rowSpan:2},"2x2":{colSpan:2,rowSpan:2}};function oa(t){return sa[t]}function qe(t,e){return{colSpan:Math.min(t.colSpan,e),rowSpan:t.rowSpan}}function ia(t,e){if(t.length===0||e<=0)return{grid:[],positions:[]};const n=[],s=[];function l(i,d,c,f){if(d+f>e)return!1;for(let u=i;u<i+c;u++)for(let v=d;v<d+f;v++)if(n[u]?.[v]!=null)return!1;return!0}function o(i){for(;n.length<i;)n.push(new Array(e).fill(null))}function r(i,d,c,f,u){o(d+f);for(let v=d;v<d+f;v++)for(let _=c;_<c+u;_++)n[v][_]=i;s.push({cardIndex:i,row:d,col:c,rowSpan:f,colSpan:u})}for(let i=0;i<t.length;i++){const{span:d}=t[i],c=qe(d,e),{rowSpan:f,colSpan:u}=c;let v=!1;for(let _=0;!v;_++){o(_+1);for(let y=0;y<=e-u;y++)if(l(_,y,f,u)){r(i,_,y,f,u),v=!0;break}}}return{grid:n,positions:s}}const Je={colSpan:1,rowSpan:1};function la(t,e,n){const s={};for(const l of t){const o=e?.[l.id],r=o?oa(o):Je;s[l.id]=qe(r,n)}return s}const ca={colSpan:2,rowSpan:1},da="__clock__";function ua(t,e,n){const s={id:da,span:ca},l=t.map(o=>({id:o.id,span:e[o.id]??Je}));return ia([s,...l],n)}var fa=x('<link rel="preconnect" href="https://script.google.com"/> <link rel="preconnect" href="https://script.googleusercontent.com"/>',1),ga=x('<div class="flex h-full items-center justify-center"><!></div>'),va=x('<button type="button" class="btn-danger">再取得</button>'),ma=x('<div class="flex h-full items-center justify-center"><!></div>'),pa=x('<div class="flex h-full items-center justify-center"><!></div>'),ha=x('<div class="mb-6"><!></div>'),Sa=x('<div class="mb-2 rounded-lg bg-slate-200/90 py-1.5 text-center text-base font-medium text-slate-700 dark:bg-white/10 dark:text-slate-300" role="status" aria-label="表示データの日付"> </div>'),_a=x("<!> <!>",1),ba=x('<!> <!> <div class="min-h-0 flex-1"><!></div>',1),wa=x('<div class="flex h-full items-center justify-center"><!></div>'),xa=x('<button type="button" class="fixed top-4 right-4 z-20 flex size-11 items-center justify-center rounded-full bg-white/80 text-slate-500 shadow-sm ring-1 ring-slate-200/80 backdrop-blur-sm transition-colors hover:bg-white hover:text-slate-700 dark:bg-slate-800/80 dark:text-slate-400 dark:ring-slate-700/60 dark:hover:bg-slate-700 dark:hover:text-slate-200" aria-label="表示設定を開く"><!></button> <section class="flex h-full flex-col p-4 md:p-6 xl:p-8" aria-label="サイネージ指標"><!></section>',1),ya=x("<!> <!>",1);function Za(t,e){ze(e,!0);const n=["blue","orange","green"];let s=j("blue");ft(()=>{S(s,n[Math.floor(Math.random()*n.length)],!0)});const l=p(()=>e.data.slug),o=p(()=>e.data.boardSlug??void 0),r=p(()=>Zt(a(l))),i=jt({get scalingSettings(){return a(r).scaling},get gridSettings(){return a(r).grid}}),d=Pt({get intervalMs(){return a(r).timer.updateInterval}}),c=Ft({get slug(){return a(l)},get defaults(){return Bt}}),f=new Map([["Ctrl+Shift+S",c.toggleDrawer]]);Lt({get shortcuts(){return f}});const u=p(()=>i.scaleFactor*c.settings.cardSizeScale),v=p(()=>lt(e.data.metrics??[])),_=p(()=>la(a(v),a(r).cardLayout?.cardSpans,i.gridColumns??a(r).grid.minColumns)),y=p(()=>ua(a(v),a(_),i.gridColumns??a(r).grid.minColumns)),K=Ot({get cardCount(){return a(v).length+1},get gridColumns(){return i.gridColumns??a(r).grid.minColumns},get layoutMap(){return a(y)}}),I=a(o)?it({get slug(){return a(o)}}):void 0,F=ct(()=>({dashboardData:I?.dashboardData??null,effectiveIndex:null,selectedDate:null})),Se=p(()=>{const E=F.sinageDisplayData?.日付;if(!E)return"";const ae=vt(new Date(E));return`${F.sinageIsShowingToday?"今日":"前日"}のデータを表示しています（${ae}）`});let ee=j(!1);U(()=>{const E=I?.dashboardData;E&&E.length>0&&(a(ee)?d.restart():(S(ee,!0),Ke("sinage-initial-data-loaded")))}),U(()=>{Ke("sinage-render-start")});var te=ya();ht("r7yzkw",E=>{var ae=fa();Fe(2),h(E,ae)});var _e=z(te);ea(_e,{children:(E,ae)=>{var le=xa(),W=z(le);W.__click=function(...R){c.toggleDrawer?.apply(this,R)};var Ae=m(W);Ze(Ae,{size:20}),g(W);var be=b(W,2),we=m(be);{var ce=R=>{var B=ga(),ue=m(B);me(ue,{variant:"empty",title:"ボード未設定",message:"このサイネージにはボードが紐付けられていません。"}),g(B),h(R,B)},de=R=>{var B=Z(),ue=z(B);{var xe=P=>{var N=ma(),ne=m(N);me(ne,{variant:"error",title:"データの取得に失敗しました",get message(){return I.error.message},children:(X,ge)=>{var T=va();T.__click=()=>I?.retryFetch(),h(X,T)},$$slots:{default:!0}}),g(N),h(P,N)},fe=P=>{var N=Z(),ne=z(N);{var X=T=>{var L=pa(),G=m(L);me(G,{variant:"loading",title:"読み込み中",message:"データを取得しています…"}),g(L),h(T,L)},ge=T=>{var L=Z(),G=z(L);{var je=A=>{var V=ba(),Y=z(V);{var ye=w=>{var M=ha(),k=m(M);me(k,{variant:"error",title:"更新エラー",get message(){return I.error.message}}),g(M),h(w,M)};se(Y,w=>{I?.error&&w(ye)})}var ve=b(Y,2);{var Ce=w=>{var M=Sa(),k=m(M,!0);g(M),Q(()=>he(k,a(Se))),h(w,M)};se(ve,w=>{a(Se)&&w(Ce)})}var ke=b(ve,2),C=m(ke);Jt(C,{get gridSettings(){return a(r).grid},get layoutSettings(){return a(r).layout},get gridColumns(){return i.gridColumns},get scaleFactor(){return a(u)},hasMixedSpans:!0,get targetRows(){return a(y).grid.length},children:(w,M)=>{var k=_a(),q=z(k);{let J=p(()=>K.selectedIndex===0);Ue(q,{get isSelected(){return a(J)},get scaleFactor(){return a(u)},colSpan:2,rowSpan:1,children:(O,Me)=>{Yt(O,{get variant(){return a(s)},get scaleFactor(){return a(u)}})},$$slots:{default:!0}})}var De=b(q,2);Ve(De,19,()=>a(v),J=>J.id,(J,O,Me)=>{const Pe=p(()=>a(_)[a(O).id]??{colSpan:1,rowSpan:1});{let Qe=p(()=>K.selectedIndex===a(Me)+1);Ue(J,{get isSelected(){return a(Qe)},get scaleFactor(){return a(u)},get colSpan(){return a(Pe).colSpan},get rowSpan(){return a(Pe).rowSpan},children:(et,Ca)=>{{let tt=p(()=>wt(a(O),F.sinageDisplayData)),at=p(()=>dt(a(O))),nt=p(()=>ut(a(O))),rt=p(()=>a(Pe).colSpan>=2?"horizontal":"vertical");bt(et,{get title(){return a(O).title},get value(){return a(tt)},get variant(){return a(at)},get badge(){return a(nt)},get layout(){return a(rt)}})}},$$slots:{default:!0}})}}),h(w,k)},$$slots:{default:!0}}),g(ke),h(A,V)},$=A=>{var V=wa(),Y=m(V);me(Y,{variant:"empty",title:"データがありません",message:"期間や更新状況を確認してください。"}),g(V),h(A,V)};se(G,A=>{F.sinageDisplayData?A(je):A($,!1)},!0)}h(T,L)};se(ne,T=>{I?.isLoading&&!F.sinageDisplayData?T(X):T(ge,!1)},!0)}h(P,N)};se(ue,P=>{I?.error&&!F.sinageDisplayData?P(xe):P(fe,!1)},!0)}h(R,B)};se(we,R=>{a(o)?R(de,!1):R(ce)})}g(be),Q(()=>{D(W,"aria-expanded",c.isOpen),D(be,"data-sinage-slug",a(l))}),h(E,le)}});var Ge=b(_e,2);ra(Ge,{get open(){return c.isOpen},get settings(){return c.settings},get onSettingsChange(){return c.updateSettings},get onSave(){return c.save},get onCancel(){return c.closeDrawer},get onReset(){return c.reset}}),h(t,te),Ie()}Be(["click"]);export{Za as component,Ha as universal};
