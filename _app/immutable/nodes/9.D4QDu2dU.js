import"../chunks/B9-xpt6i.js";import{M as J,l as fe}from"../chunks/CyAkH-4i.js";import{B as He}from"../chunks/7QimJVlU.js";import{g as Ke}from"../chunks/BoWGEMcG.js";import{g as We,c as je,d as ze,r as Xe,a as qe,T as Je,p as Fe,n as Qe,t as Ze,u as $e,b as et,s as Te}from"../chunks/BwLfPz45.js";import"../chunks/DsnmJJEf.js";import{p as M,aU as S,d as p,a as D,b as V,g as a,u as d,b9 as Se,c as R,v as le,r as x,f as L,b5 as Z,b8 as tt,s as Y,ay as Me,aV as at,t as _e,x as I,M as B,S as rt,aT as nt,j as me,k as ot,ba as st,$ as it}from"../chunks/Dj_qSXc_.js";import{h as lt}from"../chunks/DYYehU_A.js";import{f as Ve,a as ce,s as de}from"../chunks/B1sSVCCJ.js";import{b as ct}from"../chunks/D_zn7YC-.js";import{R as dt,b as ut,c as gt,d as ft,s as vt,F as ht,I as bt,D as mt}from"../chunks/B9A2VU6m.js";import{i as F,r as $,p as yt,c as De,d as Tt,s as Ee,g as ve,e as ye}from"../chunks/Cie8SrI_.js";import{c as Dt,d as xe,m as ee,u as Ct,b as pt,e as pe,n as Q,f as ie,g as Ae}from"../chunks/CCr0WPC9.js";import{m as ue,g as W,n as It,o as St,p as _t,j as xt,q as Pt,v as Rt,a as Et,x as Pe,y as At,z as Lt,B as wt,d as q,C as Ft,i as Mt,D as Vt,E as Nt,F as Ot,G as Bt,H as kt,I as Ut,J as Gt,K as Yt,L as Ht,S as Kt,N as Wt}from"../chunks/YvPky1bd.js";import"../chunks/0F8CCDVG.js";import{c as jt,b as Ce,M as zt,g as Xt,D as qt,d as Jt,e as Ne}from"../chunks/DCurxu3d.js";import"../chunks/DrBvUoO-.js";import"../chunks/_vGz1ruN.js";import{s as Oe,o as Be}from"../chunks/DGrEk6DV.js";import{s as A}from"../chunks/cMrtn-FD.js";import{b as te,d as Qt}from"../chunks/PczVBC9G.js";const z=Dt();var Zt=Et("tabs").parts("root","list","trigger","content","indicator"),oe=Zt.build(),$t=t=>t.ids?.root??`tabs:${t.id}`,se=t=>t.ids?.list??`tabs:${t.id}:list`,Ie=(t,e)=>t.ids?.content?.(e)??`tabs:${t.id}:content-${e}`,j=(t,e)=>t.ids?.trigger?.(e)??`tabs:${t.id}:trigger-${e}`,ke=t=>t.ids?.indicator??`tabs:${t.id}:indicator`,ea=t=>t.getById(se(t)),ta=(t,e)=>t.getById(Ie(t,e)),he=(t,e)=>e!=null?t.getById(j(t,e)):null,Le=t=>t.getById(ke(t)),ae=t=>{const r=`[role=tab][data-ownedby='${CSS.escape(se(t))}']:not([disabled])`;return Nt(ea(t),r)},aa=t=>Yt(ae(t)),ra=t=>Gt(ae(t)),na=(t,e)=>kt(ae(t),j(t,e.value),e.loopFocus),oa=(t,e)=>Bt(ae(t),j(t,e.value),e.loopFocus),Ue=t=>({x:t?.offsetLeft??0,y:t?.offsetTop??0,width:t?.offsetWidth??0,height:t?.offsetHeight??0}),sa=(t,e)=>{const r=Ot(ae(t),j(t,e));return Ue(r)};function ia(t,e){const{state:r,send:n,context:o,prop:s,scope:u}=t,i=s("translations"),c=r.matches("focused"),v=s("orientation")==="vertical",f=s("orientation")==="horizontal",b=s("composite");function g(l){return{selected:o.get("value")===l.value,focused:o.get("focusedValue")===l.value,disabled:!!l.disabled}}return{value:o.get("value"),focusedValue:o.get("focusedValue"),setValue(l){n({type:"SET_VALUE",value:l})},clearValue(){n({type:"CLEAR_VALUE"})},setIndicatorRect(l){const m=j(u,l);n({type:"SET_INDICATOR_RECT",id:m})},syncTabIndex(){n({type:"SYNC_TAB_INDEX"})},selectNext(l){n({type:"TAB_FOCUS",value:l,src:"selectNext"}),n({type:"ARROW_NEXT",src:"selectNext"})},selectPrev(l){n({type:"TAB_FOCUS",value:l,src:"selectPrev"}),n({type:"ARROW_PREV",src:"selectPrev"})},focus(){const l=o.get("value");l&&he(u,l)?.focus()},getRootProps(){return e.element({...oe.root.attrs,id:$t(u),"data-orientation":s("orientation"),"data-focus":W(c),dir:s("dir")})},getListProps(){return e.element({...oe.list.attrs,id:se(u),role:"tablist",dir:s("dir"),"data-focus":W(c),"aria-orientation":s("orientation"),"data-orientation":s("orientation"),"aria-label":i?.listLabel,onKeyDown(l){if(l.defaultPrevented||_t(l)||!xt(l.currentTarget,Pt(l)))return;const m={ArrowDown(){f||n({type:"ARROW_NEXT",key:"ArrowDown"})},ArrowUp(){f||n({type:"ARROW_PREV",key:"ArrowUp"})},ArrowLeft(){v||n({type:"ARROW_PREV",key:"ArrowLeft"})},ArrowRight(){v||n({type:"ARROW_NEXT",key:"ArrowRight"})},Home(){n({type:"HOME"})},End(){n({type:"END"})}};let y=Rt(l,{dir:s("dir"),orientation:s("orientation")});const h=m[y];if(h){l.preventDefault(),h(l);return}}})},getTriggerState:g,getTriggerProps(l){const{value:m,disabled:y}=l,h=g(l);return e.button({...oe.trigger.attrs,role:"tab",type:"button",disabled:y,dir:s("dir"),"data-orientation":s("orientation"),"data-disabled":W(y),"aria-disabled":y,"data-value":m,"aria-selected":h.selected,"data-selected":W(h.selected),"data-focus":W(h.focused),"aria-controls":h.selected?Ie(u,m):void 0,"data-ownedby":se(u),"data-ssr":W(o.get("ssr")),id:j(u,m),tabIndex:h.selected&&b?0:-1,onFocus(){n({type:"TAB_FOCUS",value:m})},onBlur(T){T.relatedTarget?.getAttribute("role")!=="tab"&&n({type:"TAB_BLUR"})},onClick(T){T.defaultPrevented||It(T)||y||(St()&&T.currentTarget.focus(),n({type:"TAB_CLICK",value:m}))}})},getContentProps(l){const{value:m}=l,y=o.get("value")===m;return e.element({...oe.content.attrs,dir:s("dir"),id:Ie(u,m),tabIndex:b?0:-1,"aria-labelledby":j(u,m),role:"tabpanel","data-ownedby":se(u),"data-selected":W(y),"data-orientation":s("orientation"),hidden:!y})},getIndicatorProps(){const l=o.get("indicatorRect"),m=l==null||l.width===0&&l.height===0&&l.x===0&&l.y===0;return e.element({id:ke(u),...oe.indicator.attrs,dir:s("dir"),"data-orientation":s("orientation"),hidden:m,style:{"--transition-property":"left, right, top, bottom, width, height","--left":ue(l?.x),"--top":ue(l?.y),"--width":ue(l?.width),"--height":ue(l?.height),position:"absolute",willChange:"var(--transition-property)",transitionProperty:"var(--transition-property)",transitionDuration:"var(--transition-duration, 150ms)",transitionTimingFunction:"var(--transition-timing-function)",[f?"left":"top"]:f?"var(--left)":"var(--top)"}})}}}var{createMachine:la}=Mt(),ca=la({props({props:t}){return{dir:"ltr",orientation:"horizontal",activationMode:"automatic",loopFocus:!0,composite:!0,navigate(e){Ft(e.node)},defaultValue:null,...t}},initialState(){return"idle"},context({prop:t,bindable:e}){return{value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(r){t("onValueChange")?.({value:r})}})),focusedValue:e(()=>({defaultValue:t("value")||t("defaultValue"),sync:!0,onChange(r){t("onFocusChange")?.({focusedValue:r})}})),ssr:e(()=>({defaultValue:!0})),indicatorRect:e(()=>({defaultValue:null}))}},watch({context:t,prop:e,track:r,action:n}){r([()=>t.get("value")],()=>{n(["syncIndicatorRect","syncTabIndex","navigateIfNeeded"])}),r([()=>e("dir"),()=>e("orientation")],()=>{n(["syncIndicatorRect"])})},on:{SET_VALUE:{actions:["setValue"]},CLEAR_VALUE:{actions:["clearValue"]},SET_INDICATOR_RECT:{actions:["setIndicatorRect"]},SYNC_TAB_INDEX:{actions:["syncTabIndex"]}},entry:["syncIndicatorRect","syncTabIndex","syncSsr"],exit:["cleanupObserver"],states:{idle:{on:{TAB_FOCUS:{target:"focused",actions:["setFocusedValue"]},TAB_CLICK:{target:"focused",actions:["setFocusedValue","setValue"]}}},focused:{on:{TAB_CLICK:{actions:["setFocusedValue","setValue"]},ARROW_PREV:[{guard:"selectOnFocus",actions:["focusPrevTab","selectFocusedTab"]},{actions:["focusPrevTab"]}],ARROW_NEXT:[{guard:"selectOnFocus",actions:["focusNextTab","selectFocusedTab"]},{actions:["focusNextTab"]}],HOME:[{guard:"selectOnFocus",actions:["focusFirstTab","selectFocusedTab"]},{actions:["focusFirstTab"]}],END:[{guard:"selectOnFocus",actions:["focusLastTab","selectFocusedTab"]},{actions:["focusLastTab"]}],TAB_FOCUS:{actions:["setFocusedValue"]},TAB_BLUR:{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{selectOnFocus:({prop:t})=>t("activationMode")==="automatic"},actions:{selectFocusedTab({context:t,prop:e}){q(()=>{const r=t.get("focusedValue");if(!r)return;const o=e("deselectable")&&t.get("value")===r?null:r;t.set("value",o)})},setFocusedValue({context:t,event:e,flush:r}){e.value!=null&&r(()=>{t.set("focusedValue",e.value)})},clearFocusedValue({context:t}){t.set("focusedValue",null)},setValue({context:t,event:e,prop:r}){const n=r("deselectable")&&t.get("value")===t.get("focusedValue");t.set("value",n?null:e.value)},clearValue({context:t}){t.set("value",null)},focusFirstTab({scope:t}){q(()=>{aa(t)?.focus()})},focusLastTab({scope:t}){q(()=>{ra(t)?.focus()})},focusNextTab({context:t,prop:e,scope:r,event:n}){const o=n.value??t.get("focusedValue");if(!o)return;const s=na(r,{value:o,loopFocus:e("loopFocus")});q(()=>{e("composite")?s?.focus():s?.dataset.value!=null&&t.set("focusedValue",s.dataset.value)})},focusPrevTab({context:t,prop:e,scope:r,event:n}){const o=n.value??t.get("focusedValue");if(!o)return;const s=oa(r,{value:o,loopFocus:e("loopFocus")});q(()=>{e("composite")?s?.focus():s?.dataset.value!=null&&t.set("focusedValue",s.dataset.value)})},syncTabIndex({context:t,scope:e}){q(()=>{const r=t.get("value");if(!r)return;const n=ta(e,r);if(!n)return;Ut(n).length>0?n.removeAttribute("tabindex"):n.setAttribute("tabindex","0")})},cleanupObserver({refs:t}){const e=t.get("indicatorCleanup");e&&e()},setIndicatorRect({context:t,event:e,scope:r}){const n=e.id??t.get("value");!Le(r)||!n||!he(r,n)||t.set("indicatorRect",sa(r,n))},syncSsr({context:t}){t.set("ssr",!1)},syncIndicatorRect({context:t,refs:e,scope:r}){const n=e.get("indicatorCleanup");if(n&&n(),!Le(r))return;const s=()=>{const c=he(r,t.get("value"));if(!c)return;const v=Ue(c);t.set("indicatorRect",f=>Vt(f,v)?f:v)};s();const u=ae(r),i=Lt(...u.map(c=>wt.observe(c,s)));e.set("indicatorCleanup",i)},navigateIfNeeded({context:t,prop:e,scope:r}){const n=t.get("value");if(!n)return;const o=he(r,n);At(o)&&e("navigate")?.({value:n,node:o,href:o.href})}}}}),da=xe()(["activationMode","composite","deselectable","dir","getRootNode","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value","defaultValue"]),ua=Pe(da),ga=xe()(["disabled","value"]),fa=Pe(ga),va=xe()(["value"]),ha=Pe(va),ba=L("<div><!></div>");function ma(t,e){M(e,!0);const r=$(e,["$$slots","$$events","$$legacy"]),n=z.consume(),o=d(()=>ha(r)),s=d(()=>Se(a(o),2)),u=d(()=>a(s)[0]),i=d(()=>a(s)[1]),c=d(()=>a(i).element),v=d(()=>a(i).children),f=d(()=>Z(a(i),["element","children"])),b=d(()=>ee(n().getContentProps(a(u)),a(f)));var g=S(),l=p(g);{var m=h=>{var T=S(),C=p(T);A(C,()=>a(c),()=>a(b)),D(h,T)},y=h=>{var T=ba();te(T,()=>({...a(b)}));var C=R(T);A(C,()=>a(v)??le),x(T),D(h,T)};F(l,h=>{a(c)?h(m):h(y,!1)})}D(t,g),V()}var ya=L("<div></div>");function Ta(t,e){M(e,!0);const r=$(e,["$$slots","$$events","$$legacy"]),n=z.consume(),o=d(()=>e.element),s=d(()=>Z(r,["element"])),u=d(()=>ee(n().getIndicatorProps(),a(s)));var i=S(),c=p(i);{var v=b=>{var g=S(),l=p(g);A(l,()=>a(o),()=>a(u)),D(b,g)},f=b=>{var g=ya();te(g,()=>({...a(u)})),D(b,g)};F(c,b=>{a(o)?b(v):b(f,!1)})}D(t,i),V()}var Da=L("<div><!></div>");function Ca(t,e){M(e,!0);const r=$(e,["$$slots","$$events","$$legacy"]),n=z.consume(),o=d(()=>e.element),s=d(()=>e.children),u=d(()=>Z(r,["element","children"])),i=d(()=>ee(n().getListProps(),a(u)));var c=S(),v=p(c);{var f=g=>{var l=S(),m=p(l);A(m,()=>a(o),()=>a(i)),D(g,l)},b=g=>{var l=Da();te(l,()=>({...a(i)}));var m=R(l);A(m,()=>a(s)??le),x(l),D(g,l)};F(v,g=>{a(o)?g(f):g(b,!1)})}D(t,c),V()}function pa(t,e){M(e,!0);const r=z.consume(),n=d(()=>e.children);var o=S(),s=p(o);A(s,()=>a(n),()=>r),D(t,o),V()}var Ia=L("<div><!></div>");function Sa(t,e){M(e,!0);const r=$(e,["$$slots","$$events","$$legacy"]),n=d(()=>e.element),o=d(()=>e.children),s=d(()=>e.value),u=d(()=>Z(r,["element","children","value"])),i=d(()=>ee(a(s)().getRootProps(),a(u)));z.provide(()=>a(s)());var c=S(),v=p(c);{var f=g=>{var l=S(),m=p(l);A(m,()=>a(n),()=>a(i)),D(g,l)},b=g=>{var l=Ia();te(l,()=>({...a(i)}));var m=R(l);A(m,()=>a(o)??le),x(l),D(g,l)};F(v,g=>{a(n)?g(f):g(b,!1)})}D(t,c),V()}function _a(t){const e=Ct(ca,t),r=d(()=>ia(e,pt));return()=>a(r)}var xa=L("<div><!></div>");function Pa(t,e){const r=tt();M(e,!0);const n=$(e,["$$slots","$$events","$$legacy"]),o=d(()=>ua(n)),s=d(()=>Se(a(o),2)),u=d(()=>a(s)[0]),i=d(()=>a(s)[1]),c=d(()=>a(i).element),v=d(()=>a(i).children),f=d(()=>Z(a(i),["element","children"])),b=_a(()=>({...a(u),id:r})),g=d(()=>ee(b().getRootProps(),a(f)));z.provide(()=>b());var l=S(),m=p(l);{var y=T=>{var C=S(),E=p(C);A(E,()=>a(c),()=>a(g)),D(T,C)},h=T=>{var C=xa();te(C,()=>({...a(g)}));var E=R(C);A(E,()=>a(v)??le),x(C),D(T,C)};F(m,T=>{a(c)?T(y):T(h,!1)})}D(t,l),V()}var Ra=L("<button><!></button>");function Ea(t,e){M(e,!0);const r=$(e,["$$slots","$$events","$$legacy"]),n=z.consume(),o=d(()=>fa(r)),s=d(()=>Se(a(o),2)),u=d(()=>a(s)[0]),i=d(()=>a(s)[1]),c=d(()=>a(i).element),v=d(()=>a(i).children),f=d(()=>Z(a(i),["element","children"])),b=d(()=>ee(n().getTriggerProps(a(u)),a(f)));var g=S(),l=p(g);{var m=h=>{var T=S(),C=p(T);A(C,()=>a(c),()=>a(b)),D(h,T)},y=h=>{var T=Ra();te(T,()=>({...a(b)}));var C=R(T);A(C,()=>a(v)??le),x(T),D(h,T)};F(l,h=>{a(c)?h(m):h(y,!1)})}D(t,g),V()}const ge=Object.assign(Pa,{Provider:Sa,Context:pa,List:Ca,Trigger:Ea,Indicator:Ta,Content:ma});var Aa=L('<span class="inline-flex flex-1"><!></span>'),La=L("<!> <!>",1),wa=L('<div class="relative flex flex-1 flex-col pt-3"><!></div>');function Fa(t,e){M(e,!0);let r=yt(e,"containerElement",15,null);const n=d(()=>jt(void 0,e.boardFeatures));var o=wa(),s=R(o);ge(s,{get value(){return e.value},get onValueChange(){return e.onValueChange},class:"flex flex-1 flex-col",children:(u,i)=>{var c=La(),v=p(c);De(v,()=>ge.List,(b,g)=>{g(b,{class:"mb-0 flex gap-5 border-b-0 px-4 pb-0 md:px-8","aria-label":"ボードタブナビゲーション",children:(l,m)=>{var y=S(),h=p(y);pe(h,17,()=>a(n),T=>T.id,(T,C)=>{var E=Aa(),H=R(E);De(H,()=>ge.Trigger,(G,k)=>{k(G,{get value(){return a(C).id},get class(){return a(C).triggerClass},children:(_,N)=>{Me();var O=at();_e(()=>Oe(O,a(C).label)),D(_,O)},$$slots:{default:!0}})}),x(E),D(T,E)}),D(l,y)},$$slots:{default:!0}})});var f=Y(v,2);pe(f,17,()=>a(n),b=>b.id,(b,g)=>{var l=S(),m=p(l);De(m,()=>ge.Content,(y,h)=>{h(y,{get value(){return a(g).id},get class(){return`bg-page relative flex flex-1 flex-col border-t-3 ${a(g).borderColorLight??""} dark:${a(g).borderColorDark??""}`},children:(T,C)=>{var E=S(),H=p(E);{var G=_=>{var N=S(),O=p(N);A(O,()=>e.boardContent),D(_,N)},k=_=>{var N=S(),O=p(N);{var X=P=>{var w=S(),K=p(w);A(K,()=>e.dataContent),D(P,w)},re=P=>{var w=S(),K=p(w);{var U=ne=>{var Re=S(),Ye=p(Re);A(Ye,()=>e.reportContent),D(ne,Re)};F(K,ne=>{a(g).id==="report"&&e.reportContent&&ne(U)},!0)}D(P,w)};F(O,P=>{a(g).id==="data"?P(X):P(re,!1)},!0)}D(_,N)};F(H,_=>{a(g).id==="board"?_(G):_(k,!1)})}D(T,E)},$$slots:{default:!0}})}),D(b,l)}),D(u,c)},$$slots:{default:!0}}),x(o),Ve(o,u=>r(u),()=>r()),D(t,o),V()}var Ma=L('<div class="mb-6"><!></div>'),Va=L('<div class="card-base mb-5 flex flex-col items-start gap-2 p-4 md:flex-row md:items-center md:justify-between"><div class="flex items-center gap-3"><span class="material-symbols-outlined text-primary-ui rounded-md bg-sky-50 p-1.5 dark:bg-sky-900/30">calendar_today</span> <span class="font-medium text-slate-700 dark:text-slate-200"> </span></div> <span class="text-tertiary text-sm">指標カードをクリックすると詳細グラフを表示します</span></div> <div class="grid grid-cols-2 gap-5 md:grid-cols-3 lg:grid-cols-4" aria-label="経営指標カード一覧"></div>',1),Na=L('<section class="px-4 py-6 md:px-8" aria-label="ボード"><!> <!></section>');function Oa(t,e){M(e,!0);function r(f,b){const g=b[f.dataKey];return{dataKey:f.dataKey,rawValue:g??"N/A",unit:f.unit||"(なし)",order:f.order,...f.source&&{source:f.source},...f.isDev!==void 0&&{isDev:f.isDev},...f.environments&&{environments:f.environments.join(", ")}}}const n=d(()=>{if(!e.displayData?.日付)return"";const f=Tt(new Date(e.displayData.日付));return e.isShowingYesterday?`前日（${f}）のデータを表示しています`:`${f}のデータを表示しています`});var o=Na(),s=R(o);{var u=f=>{var b=Ma(),g=R(b);Ce(g,{variant:"error",title:"エラーが発生しました",get message(){return e.error.message}}),x(b),D(f,b)};F(s,f=>{e.error&&f(u)})}var i=Y(s,2);{var c=f=>{Ce(f,{variant:"loading",title:"読み込み中",message:"データを取得しています…"})},v=f=>{var b=S(),g=p(b);{var l=y=>{var h=Va(),T=p(h),C=R(T),E=Y(R(C),2),H=R(E,!0);x(E),x(C),Me(2),x(T);var G=Y(T,2);pe(G,21,()=>e.metrics,k=>k.id,(k,_)=>{{let N=d(()=>Xt(a(_),e.displayData)),O=d(()=>We(a(_))),X=d(()=>je(a(_))),re=d(()=>ze(a(_),e.devMode)?r(a(_),e.displayData):void 0);zt(k,{get title(){return a(_).title},get value(){return a(N)},onClick:()=>e.onMetricClick(a(_).id),get variant(){return a(O)},get badge(){return a(X)},get devInfo(){return a(re)}})}}),x(G),_e(()=>Oe(H,a(n))),D(y,h)},m=y=>{Ce(y,{variant:"empty",title:"データがありません",message:"期間や更新状況を確認してください。"})};F(g,y=>{e.displayData?y(l):y(m,!1)},!0)}D(f,b)};F(i,f=>{e.isLoading&&!e.displayData?f(c):f(v,!1)})}x(o),D(t,o),V()}function Ba(t,e){Oa(t,{get metrics(){return e.metrics},get displayData(){return e.displayData},get isShowingYesterday(){return e.isShowingYesterday},get isLoading(){return e.isLoading},get error(){return e.error},get devMode(){return e.devMode},get onMetricClick(){return e.onMetricClick}})}var ka=L('<div class="hidden h-full md:flex md:flex-row"><aside class="flex-shrink-0 overflow-y-auto"><!></aside> <section class="relative min-w-0 flex-1"><!></section></div>');function Ua(t,e){M(e,!0);var r=ka(),n=R(r),o=R(n);dt(o,{get hospitalName(){return e.hospitalName},get selectedCategory(){return e.selectedCategory},get dateFrom(){return e.dateFrom},get dateTo(){return e.dateTo},get onCategoryChange(){return e.onCategoryChange},get onDateFromChange(){return e.onDateFromChange},get onDateToChange(){return e.onDateToChange},get onReset(){return e.onReset}}),x(n);var s=Y(n,2),u=R(s);ut(u,{get iframeLoading(){return e.iframeLoading},get iframeSrc(){return e.iframeSrc},get title(){return`${e.hospitalName??""}のレポート`},get onIframeLoad(){return e.onIframeLoad},spinnerSize:"lg"}),x(s),x(r),_e(()=>Qt(n,`width: ${Ht.METRICS_PANEL_WIDTH}px; scrollbar-gutter: stable;`)),D(t,r),V()}var Ga=L('<div class="flex h-full flex-1" aria-label="レポート"><!> <!></div>');function Ya(t,e){M(e,!0);let r=B(!0),n=B("all"),o=B(""),s=B("");const u=d(()=>"");function i(){I(n,"all"),I(o,""),I(s,"")}function c(h){I(n,h,!0),I(r,!0)}function v(h){I(o,h,!0),I(r,!0)}function f(h){I(s,h,!0),I(r,!0)}function b(){I(r,!1)}const g=d(()=>({hospitalName:e.hospitalName,selectedCategory:a(n),dateFrom:a(o),dateTo:a(s),iframeLoading:a(r),iframeSrc:a(u),onCategoryChange:c,onDateFromChange:v,onDateToChange:f,onReset:i,onIframeLoad:b}));var l=Ga(),m=R(l);gt(m,Ee(()=>a(g)));var y=Y(m,2);Ua(y,Ee(()=>a(g))),x(l),D(t,l),V()}const Ha=async({data:t})=>{const e=Ke(t.slug),r={slug:t.slug,metricDefinitions:t.metricDefinitions,graphDefinitions:t.graphDefinitions},n=Xe(r),o=qe(r),s={...e,buttons:t.buttons,metrics:n,graphs:o};return{board:t.board,config:s,slug:t.slug,subnavItems:t.subnavItems}},Lr=Object.freeze(Object.defineProperty({__proto__:null,load:Ha},Symbol.toStringTag,{value:"Module"}));function Ka(t){let e=B(rt(qt)),r=B(null),n=null;function o(){n!=null&&(clearTimeout(n),n=null)}function s(){t.tabsContainerRef&&nt().then(()=>{requestAnimationFrame(()=>{if(!t.tabsContainerRef)return;const i=t.tabsContainerRef.getBoundingClientRect(),c=window.scrollY||document.documentElement.scrollTop,v=i.top+c,f=Math.max(0,v-Wt);window.scrollTo({top:f,behavior:"smooth"})})})}function u(i){I(e,Je.parse(i.value),!0),t.onTabChangeUrl?.(a(e)),Jt(a(e))&&(I(r,"tab"),s(),o(),n=setTimeout(()=>{n=null,I(r,null)},Kt))}return{get currentTab(){return a(e)},set currentTab(i){I(e,i,!0)},get scrollOperation(){return a(r)},handleTabChange:u,scrollToDataTab:s}}function Wa(t){let e=B(null);function r(o){I(e,o,!0)}function n(){I(e,null)}return me(()=>{if(a(e))return t.setHighlight(a(e)),()=>{t.setHighlight(null)}}),{get selectedMetricId(){return a(e)},set selectedMetricId(o){I(e,o,!0)},handleMetricSelect:r,resetSelection:n}}function ja(t,e=J){for(let r=t.length-1;r>=0;r--){const n=t[r]?.日付;if(n&&Q(n)>=e)return r}return-1}function za(t,e,r=J){if(e>0){const n=t[e-1]?.日付;if(n&&n>=r)return e-1}return e}function Xa(t,e,r,n=J){if(!t?.length)return null;if(e!==null){const s=ie(e,t);if(s!==-1)return s}if(r!==null&&r>=0&&r<t.length)return r;const o=ja(t,n);return o===-1?null:za(t,o,n)}function qa(t,e,r){return t!==null?t:e!==null&&r?.[e]?.日付?Q(r[e].日付):null}function Ja(t){const e=d(()=>t().getCurrentDateIndex()),r=d(()=>t().getSelectedDate()),n=d(()=>{const{dashboardData:s}=t();return Xa(s,a(r),a(e))}),o=d(()=>{const{dashboardData:s}=t();return qa(a(r),a(n),s)});return{get effectiveIndex(){return a(n)},get selectedDateKey(){return a(o)},get currentDateIndex(){return a(e)},get selectedDateState(){return a(r)}}}function Qa(t,e,r){if(t===null||t<=0)return!1;const n=e?.[t-1]?.日付;return n?n>=r:!1}function Za(t,e,r){if(t===null||!e?.length||t>=e.length-1)return!1;const n=e[t+1]?.日付;return n?Q(n)<=r:!1}function we(t,e){return t===e}function $a(t){const e=d(()=>{const{effectiveIndex:i,dashboardData:c}=t();return Qa(i,c,J)}),r=d(()=>{const{effectiveIndex:i,dashboardData:c}=t();return Za(i,c,ve())}),n=d(()=>Ae(ye(),J)),o=d(()=>Ae(ve(),J)),s=d(()=>we(t().selectedDateKey,ye())),u=d(()=>we(t().selectedDateKey,ve()));return{get canGoPrevious(){return a(e)},get canGoNext(){return a(r)},get canGoToYesterday(){return a(n)},get canGoToToday(){return a(o)},get isShowingYesterday(){return a(s)},get isShowingToday(){return a(u)}}}function er(t){const e=Ja(()=>({dashboardData:t().dashboardData,getCurrentDateIndex:t().getCurrentDateIndex,getSelectedDate:t().getSelectedDate})),r=$a(()=>({dashboardData:t().dashboardData,effectiveIndex:e.effectiveIndex,selectedDateKey:e.selectedDateKey}));function n(){if(!r.canGoPrevious||e.effectiveIndex===null)return;const i=e.effectiveIndex,c=t(),v=c.dashboardData?.[i-1]?.日付;v&&(c.setSelectedDate(Q(v)),c.setCurrentDateIndex(i-1))}function o(){const i=t();if(!r.canGoNext||e.effectiveIndex===null||!i.dashboardData?.length)return;const c=e.effectiveIndex+1,v=i.dashboardData[c]?.日付;v&&(i.setSelectedDate(Q(v)),i.setCurrentDateIndex(c))}function s(){const i=t(),c=ye();i.setSelectedDate(c);const v=ie(c,i.dashboardData);v!==-1&&i.setCurrentDateIndex(v)}function u(){const i=t(),c=ve();i.setSelectedDate(c);const v=ie(c,i.dashboardData);v!==-1&&i.setCurrentDateIndex(v)}return me(()=>{const i=t();i.dashboardData?.length&&e.currentDateIndex!==null&&(e.currentDateIndex<0||e.currentDateIndex>=i.dashboardData.length)&&ot(()=>i.resetToLatest())}),{get effectiveIndex(){return e.effectiveIndex},get selectedDate(){return e.selectedDateKey},get canGoPrevious(){return r.canGoPrevious},get canGoNext(){return r.canGoNext},get canGoToYesterday(){return r.canGoToYesterday},get canGoToToday(){return r.canGoToToday},get isShowingYesterday(){return r.isShowingYesterday},get isShowingToday(){return r.isShowingToday},goToPreviousDate:n,goToNextDate:o,goToYesterday:s,goToToday:u}}function Ge(){return new URLSearchParams(window.location.hash.slice(1))}function tr(){return Fe(Ge())}async function be(t){const e=Ge(),n={...Fe(e),...t},o=Qe(n),s=Ze(o);{const u=s.toString();if(window.location.hash.slice(1)===u)return;window.location.hash=u;return}}function ar(t,e){return{tab:t.tab,metricId:t.metricId&&e.includes(t.metricId)?t.metricId:null,date:t.date}}function rr(t,e,r,n){if(Ne(t))return"latest";if(e!==null)return e;if(!r?.length||n===null)return"latest";const o=r[n]?.日付;return o?Q(o):"latest"}function nr(t){let e=B(!1),r=B(null);function n(){const u=tr();fe.debug("[useUrlStateSync] applyParamsToState:",u);const i=ar(u,t.sortedMetrics.map(c=>c.id));t.setCurrentTab(i.tab),i.metricId&&t.setSelectedMetricId(i.metricId),i.date!=="latest"?(fe.debug("[useUrlStateSync] setSelectedDate:",i.date),t.setSelectedDate(i.date),I(r,i.date,!0)):(fe.debug("[useUrlStateSync] resetToLatest"),t.resetToLatest())}me(()=>{a(e)&&be({tab:t.currentTab,metricId:t.selectedMetricId,date:rr(t.currentTab,t.getSelectedDate(),t.dashboardData,t.currentDateIndex)})});function o(u){if(u==="latest"){t.resetToLatest();return}if(t.setSelectedDate(u),t.dashboardData?.length){const i=ie(u,t.dashboardData);i!==-1&&t.setCurrentDateIndex(i)}}me(()=>{!a(e)||!a(r)||!t.dashboardData?.length||(o(a(r)),I(r,null))});function s(u){return window.addEventListener("hashchange",u),()=>window.removeEventListener("hashchange",u)}return Be(()=>{n();const u=s(n);return I(e,!0),u}),{get isUrlInitialized(){return a(e)}}}function or(t,e){return{type:"suiyokai",title:t?.title||"水曜会",icon:"groups",items:t?.items||[],loading:e}}function sr(t,e){return{type:"announcement",title:"お知らせ",icon:"campaign",items:t||[],loading:e}}function ir(){const t=d(()=>de.getData()),e=d(()=>de.isLoading()),r=d(()=>or(a(t),a(e))),n=d(()=>ce.getData()),o=d(()=>ce.isLoading()),s=d(()=>sr(a(n),a(o)));return Be(()=>((async()=>(await Promise.allSettled([de.fetch(),ce.fetch()])).forEach((i,c)=>{if(i.status==="rejected"){const v=["suiyokai","announcement"][c];fe.error(`[useInfoCardData] Data source '${v}' failed:`,i.reason)}}))(),()=>{de.abort(),ce.abort()})),{get suiyokaiCardProps(){return a(r)},get announcementCardProps(){return a(s)}}}function lr(t){const{dataTabContext:e}=t,r=Wa({setHighlight:c=>e.setHighlight(c)}),n=Ka({get tabsContainerRef(){return t.tabsContainerRef},onTabChangeUrl:c=>{Ne(c)?be({tab:c,date:"latest"}):be({tab:c})}}),o=$e({get slug(){return t.slug},onSlugChange(){e.resetAllStateForFacilitySwitch(),r.resetSelection(),be({tab:n.currentTab,metricId:null,date:"latest"})}}),s=er(()=>({dashboardData:o.dashboardData,getCurrentDateIndex:()=>e.dateIndex,getSelectedDate:()=>e.date,setCurrentDateIndex:c=>e.setCurrentDateIndex(c),setSelectedDate:c=>e.setSelectedDate(c),resetToLatest:()=>e.resetToLatest()})),u=et(()=>({dashboardData:o.dashboardData,effectiveIndex:s.effectiveIndex,selectedDate:s.selectedDate})),i=ir();return nr({get currentTab(){return n.currentTab},get selectedMetricId(){return r.selectedMetricId},get currentDateIndex(){return s.effectiveIndex},get dashboardData(){return o.dashboardData},get sortedMetrics(){return t.sortedMetrics},setCurrentTab:c=>{n.currentTab=c},setSelectedMetricId:c=>{r.selectedMetricId=c},setCurrentDateIndex:c=>e.setCurrentDateIndex(c),resetToLatest:()=>e.resetToLatest(),getSelectedDate:()=>e.date,setSelectedDate:c=>e.setSelectedDate(c)}),{dataSources:o,tabManager:n,metricSelection:r,dateNavigation:s,displayData:u,infoCardData:i}}var cr=L("<!> <!> <!>",1);function wr(t,e){M(e,!0);const r=d(()=>e.data.config.hospital),n=d(()=>e.data.config.metrics),o=d(()=>e.data.config.graphs),s=d(()=>e.data.config.buttons),u=d(()=>Te(a(s))),i=d(()=>Te(a(n))),c=d(()=>Te(a(o))),v=ft({initialDate:null,initialPeriod:14});vt(v);let f=B(null),b=B(null);const{dataSources:g,tabManager:l,metricSelection:m,dateNavigation:y,displayData:h,infoCardData:T}=lr({get slug(){return e.data.slug},dataTabContext:v,get tabsContainerRef(){return a(f)},get sortedMetrics(){return a(i)}});function C(P){const w=ye(),K=ie(w,g.dashboardData);K!==-1?v.setCurrentDateIndex(K):v.resetToLatest(),l.handleTabChange({value:"data"}),m.handleMetricSelect(P),v.setCompareGraphsVisible(!1)}ct(({from:P,to:w})=>{P?.url.pathname!==w?.url.pathname&&v.clearCompare()});const E=d(()=>({dataDate:h.formattedSelectedDate,canGoPrevious:y.canGoPrevious,canGoNext:y.canGoNext,onPreviousDate:y.goToPreviousDate,onNextDate:y.goToNextDate,canGoToYesterday:y.canGoToYesterday,canGoToToday:y.canGoToToday,isShowingYesterday:y.isShowingYesterday,isShowingToday:y.isShowingToday,onYesterdayDate:y.goToYesterday,onTodayDate:y.goToToday,hasDataForSelectedDate:h.hasDataForSelectedDate,onDateSelect:(P,w)=>{v.setDateAndIndex(P,w)}})),H=d(()=>({period:v.period,onPeriodChange:P=>v.setChartPeriod(P)})),G=d(()=>({metrics:a(i),selectedMetricId:m.selectedMetricId??a(i)[0]?.id??null,onMetricSelect:m.handleMetricSelect,highlightedMetricId:v.highlightedId,scrollOperation:l.scrollOperation})),k=d(()=>({graphs:a(c),dashboardData:g.dashboardData,selectedDateIndex:y.effectiveIndex,displayData:h.dataDisplayData})),_=d(()=>({isLoading:g.isLoading,hasData:!!g.dashboardData,error:g.error,hasStaleData:g.hasStaleData,onRetry:g.retryFetch,lastUpdatedText:g.lastUpdatedText}));var N=cr();lt("1k039h9",P=>{st(()=>{it.title=`${a(r).name??""} | ${a(r).dashboardTitle??""}（共愛会）`})});var O=p(N);ht(O,{get hospital(){return a(r)},get buttons(){return a(u)}});var X=Y(O,2);bt(X,{get suiyokaiCardProps(){return T.suiyokaiCardProps},get announcementCardProps(){return T.announcementCardProps}});var re=Y(X,2);Fa(re,{get value(){return l.currentTab},get onValueChange(){return l.handleTabChange},get boardFeatures(){return He[e.data.slug]},get containerElement(){return a(f)},set containerElement(U){I(f,U,!0)},boardContent:U=>{Ba(U,{get metrics(){return a(i)},get displayData(){return h.boardDisplayData},get isShowingYesterday(){return h.boardIsShowingYesterday},get isLoading(){return g.isLoading},get error(){return g.error},get devMode(){return g.devMode},onMetricClick:C})},dataContent:U=>{Ve(mt(U,{get navigation(){return a(E)},get period(){return a(H)},get metricSelection(){return a(G)},get graphData(){return a(k)},get dataState(){return a(_)},get devMode(){return g.devMode}}),ne=>I(b,ne,!0),()=>a(b))},reportContent:U=>{Ya(U,{get slug(){return e.data.slug},get hospitalName(){return a(r).name}})},$$slots:{boardContent:!0,dataContent:!0,reportContent:!0}}),D(t,N),V()}export{wr as component,Lr as universal};
