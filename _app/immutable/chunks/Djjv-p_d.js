import"./DsnmJJEf.js";import{k as $,d as O,a as u,a7 as ot,i as ne,g as t,h as N,ad as Ee,u as n,a8 as dt,p as ee,c as i,s as m,r as a,t as V,b as te,f as M,j as Ce,n as Me,l as Re,a6 as Xe,a4 as ct}from"./p4dYvpg6.js";import{b as ut,d as ve,s as z,a as j,e as He,r as vt}from"./T2Bmc5lN.js";import{I as Le,s as Ve,S as Je,e as de,B as qe,o as gt,P as Qe}from"./CS60pbwF.js";import{a as X,s as Z,b as Ge,S as mt,c as Se,d as Ie,r as De,e as ke,f as Ze}from"./Cq4yWqvx.js";import{u as $e,T as ft}from"./B3FzVGZu.js";import{l as bt}from"./BhIsClV-.js";import{ak as ht,al as we,am as Ne,ag as ze,an as xt}from"./CQy8OeFy.js";import{l as je,s as _e,p as le,c as fe}from"./OQgd7Oh0.js";import{i as U}from"./36Dr0qmW.js";import{b as et}from"./vwVNdKjP.js";import{s as pt,a as yt}from"./BzlezhIL.js";import{p as _t}from"./DXwMJcGb.js";import{r as Ue}from"./DCParltR.js";import{B as Mt,C as Be,t as Dt,s as kt,A as Ct,a as St}from"./Dh3huXxZ.js";import"./CbAJKWx5.js";import"./P7rPqgRT.js";import"./aTZK_S6W.js";import{T as Fe,g as tt}from"./BYYwbIbG.js";import{M as ge}from"./6V6pAoJc.js";import{a as be,L as at,g as rt,e as It}from"./C3ChFxzh.js";import{W as Te}from"./xh2F44ca.js";import{b as wt,d as Tt}from"./dpGQfjpZ.js";import{a as Pt}from"./CuRQ2e7u.js";function At(o,e){const r=je(e,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"m15 18-6-6 6-6"}]];Le(o,_e({name:"chevron-left"},()=>r,{get iconNode(){return l},children:(f,s)=>{var d=$(),b=O(d);Ve(b,e,"default",{}),u(f,d)},$$slots:{default:!0}}))}function Et(o,e){const r=je(e,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"m9 18 6-6-6-6"}]];Le(o,_e({name:"chevron-right"},()=>r,{get iconNode(){return l},children:(f,s)=>{var d=$(),b=O(d);Ve(b,e,"default",{}),u(f,d)},$$slots:{default:!0}}))}function Rt(o,e){const r=je(e,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M4 5h16"}],["path",{d:"M4 12h16"}],["path",{d:"M4 19h16"}]];Le(o,_e({name:"menu"},()=>r,{get iconNode(){return l},children:(f,s)=>{var d=$(),b=O(d);Ve(b,e,"default",{}),u(f,d)},$$slots:{default:!0}}))}function Lt(o,e){let r=le(e,"selected",3,!1),l=le(e,"onclick",3,()=>{});Je(o,{get label(){return e.label},get selected(){return r()},get onclick(){return l()}})}const it=Symbol("data-tab-context");class Vt{#e=ne(null);get highlightedMetricId(){return t(this.#e)}set highlightedMetricId(e){N(this.#e,e,!0)}highlightTimeoutId=null;#t=ne(Ee([]));get comparedMetricIds(){return t(this.#t)}set comparedMetricIds(e){N(this.#t,e,!0)}#a=ne(!1);get compareGraphsVisible(){return t(this.#a)}set compareGraphsVisible(e){N(this.#a,e,!0)}#r=n(()=>[...this.comparedMetricIds]);get comparedMetricIdsArray(){return t(this.#r)}set comparedMetricIdsArray(e){N(this.#r,e)}#i=n(()=>this.comparedMetricIds.length>=we.MAX_METRICS);get maxComparedReached(){return t(this.#i)}set maxComparedReached(e){N(this.#i,e)}#n=ne(null);get selectedDate(){return t(this.#n)}set selectedDate(e){N(this.#n,e,!0)}#l=ne(null);get currentDateIndex(){return t(this.#l)}set currentDateIndex(e){N(this.#l,e,!0)}dateCallbacks={};#s=ne(14);get chartPeriod(){return t(this.#s)}set chartPeriod(e){N(this.#s,e,!0)}constructor(e={}){this.selectedDate=e.initialDate??null,this.chartPeriod=e.initialPeriod??14}get highlightedId(){return this.highlightedMetricId}setHighlight(e){this.clearHighlightTimer(),this.highlightedMetricId=e,e!==null&&(this.highlightTimeoutId=setTimeout(()=>{this.highlightedMetricId=null,this.highlightTimeoutId=null},ht.DURATION_MS))}clearHighlight(){this.setHighlight(null)}clearHighlightTimer(){this.highlightTimeoutId!==null&&(clearTimeout(this.highlightTimeoutId),this.highlightTimeoutId=null)}get comparedIds(){return this.comparedMetricIdsArray}toggleCompare(e){this.comparedMetricIds.includes(e)?this.comparedMetricIds=this.comparedMetricIds.filter(r=>r!==e):this.comparedMetricIds.length<we.MAX_METRICS&&(this.comparedMetricIds=[...this.comparedMetricIds,e])}clearCompare(){this.comparedMetricIds=[],this.compareGraphsVisible=!1}get isCompareVisible(){return this.compareGraphsVisible}setCompareGraphsVisible(e){this.compareGraphsVisible=e}get isCompareMaxed(){return this.maxComparedReached}get date(){return this.selectedDate}setSelectedDate(e){this.selectedDate=e}get dateIndex(){return this.currentDateIndex}setCurrentDateIndex(e){this.currentDateIndex=e}setDateAndIndex(e,r){this.selectedDate=e,this.currentDateIndex=r}resetToLatest(){this.selectedDate=null,this.currentDateIndex=null}resetAllStateForFacilitySwitch(){this.clearHighlightTimer(),this.highlightedMetricId=null,this.comparedMetricIds=[],this.compareGraphsVisible=!1,this.selectedDate=null,this.currentDateIndex=null}setDateNavigationCallbacks(e){this.dateCallbacks=e}navigateToPrevious(){this.dateCallbacks.onPreviousDate?.()}navigateToNext(){this.dateCallbacks.onNextDate?.()}navigateToYesterday(){this.dateCallbacks.onYesterdayDate?.()}navigateToToday(){this.dateCallbacks.onTodayDate?.()}get period(){return this.chartPeriod}setChartPeriod(e){this.chartPeriod=e}destroy(){this.clearHighlightTimer()}}function Nr(o={}){return new Vt(o)}function jr(o){ot(it,o),ut(()=>{o.destroy()})}function Gt(){const o=dt(it);if(!o)throw new Error("DataTabContext is not set. Call setDataTabContext() in a parent component first.");return o}var Nt=M('<aside class="border-divider bg-card w-56 self-stretch border-r"><div class="sticky top-[90px] p-4"><div class="flex items-center justify-between"><h3 class="text-tertiary text-xs font-semibold tracking-wider uppercase">ビュー</h3> <button type="button"> </button></div> <nav class="mt-4 flex flex-col gap-2"></nav></div></aside>');function Br(o,e){ee(e,!0);const r=$e(),l=n(()=>r.comparisonType),f=n(()=>r.activeTab),s=n(()=>r.selectedViewIds),d=n(()=>r.allViewsSelected);var b=Nt(),x=i(b),v=i(x),_=m(i(v),2),p=i(_,!0);a(_),a(v);var h=m(v,2);de(h,21,()=>ft,g=>g.id,(g,D)=>{const T=n(()=>t(l)==="facility"?t(f)===t(D).id:t(s).includes(t(D).id));Lt(g,{get label(){return t(D).label},get selected(){return t(T)},onclick:()=>r.toggleView(t(D).id)})}),a(h),a(x),a(b),V(()=>{X(_,1,`rounded-md px-3 py-1.5 text-xs font-medium transition-colors ${t(d)?"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500":"border-default bg-card text-secondary hover-bg-subtle border"} disabled:cursor-not-allowed disabled:opacity-50`),_.disabled=t(l)!=="view",Z(_,"aria-disabled",t(l)!=="view"),z(p,t(d)?"すべて解除":"すべて選択")}),j("click",_,()=>{t(l)==="view"&&r.toggleSelectAllViews()}),u(o,b),te()}ve(["click"]);function jt(o,e){ee(e,!0);let r=le(e,"selected",3,!1),l=le(e,"onclick",3,()=>{});const f=n(()=>e.facility.shortName||e.facility.name);Je(o,{get label(){return t(f)},get selected(){return r()},get onclick(){return l()},class:"facility-card"}),te()}var Bt=M('<div class="mt-4 flex justify-end"><button type="button"> </button></div>'),Ft=M('<div class="border-divider bg-card overflow-y-auto border-b p-4"><div class="grid grid-cols-2 gap-3 lg:grid-cols-4"></div> <!></div>');function Fr(o,e){ee(e,!0);const r=$e(),l=n(()=>r.facilities),f=n(()=>r.selectedFacilityIds),s=n(()=>r.comparisonType),d=n(()=>r.allSelected);var b=Ft(),x=i(b);de(x,21,()=>t(l),p=>p.id,(p,h)=>{{let g=n(()=>t(f).includes(t(h).id));jt(p,{get facility(){return t(h)},get selected(){return t(g)},onclick:()=>r.toggleFacility(t(h).id)})}}),a(x);var v=m(x,2);{var _=p=>{var h=Bt(),g=i(h),D=i(g,!0);a(g),a(h),V(()=>{X(g,1,`rounded-md px-4 py-2 text-sm font-medium transition-colors ${t(d)?"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500":"border-default bg-card text-secondary hover-bg-subtle border"}`),Z(g,"aria-label",t(d)?"施設の選択をすべて解除":"施設をすべて選択"),z(D,t(d)?"すべて解除":"すべて選択")}),j("click",g,()=>r.toggleSelectAll()),u(p,h)};U(v,p=>{t(s)==="facility"&&p(_)})}a(b),u(o,b),te()}ve(["click"]);const Ye=(o,e=Me,r=Me)=>{var l=Ut();de(l,21,e,f=>f.href,(f,s)=>{var d=zt(),b=i(d);{var x=_=>{var p=Ot(),h=i(p,!0);a(p),V(()=>z(h,t(s).label)),u(_,p)},v=_=>{var p=Ht(),h=i(p,!0);a(p),V(()=>{Z(p,"href",t(s).href),X(p,1,`block rounded-lg px-4 py-3 text-sm font-medium transition-colors ${t(s).isActive?"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"text-secondary hover-bg-moderate"}`),Z(p,"aria-current",t(s).isActive?"page":void 0),z(h,t(s).label)}),j("click",p,function(...g){r()?.apply(this,g)}),u(_,p)};U(b,_=>{t(s).isDisabled?_(x):_(v,!1)})}a(d),u(f,d)}),a(l),u(o,l)};var Ot=M('<span class="text-tertiary block rounded-lg px-4 py-3 text-sm"> </span>'),Ht=M("<a> </a>"),zt=M("<li><!></li>"),Ut=M('<ul class="flex flex-col gap-1 px-3"></ul>'),Yt=M('<section class="relative flex min-h-dvh flex-col"><button type="button" class="bg-card/80 hover:bg-card absolute top-4 right-4 z-10 rounded-lg p-2 shadow-md backdrop-blur-sm transition-colors md:hidden" aria-label="メニューを開く"><!></button> <div class="flex flex-1"><nav class="border-default bg-page hidden w-64 shrink-0 flex-col border-r pt-12 md:flex" aria-label="施設メニュー"><div class="px-4 pb-4"><p class="text-tertiary text-xs font-bold tracking-wider uppercase">BOARDS</p></div> <!></nav> <div class="flex flex-1 items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-800 dark:to-slate-900"><div class="mx-auto max-w-4xl px-4 text-center sm:px-6 lg:px-8"><h1 class="text-primary mb-3 text-3xl font-bold tracking-tight sm:text-4xl">おはようございます！</h1> <p class="text-secondary mb-2 text-xl sm:text-2xl">今日も、共愛会のいまが見えます</p> <p class="text-tertiary mx-auto max-w-2xl text-base sm:text-lg">毎朝8時更新。4つの施設の経営指標をひと目で把握して、<br class="hidden sm:inline"/> データに基づく意思決定をはじめましょう</p></div></div></div> <div class="h-0"></div></section> <!>',1);function Or(o,e){ee(e,!0);const r=()=>yt(_t,"$page",l),[l,f]=pt();let s=ne(!1),d=ne(void 0);Ce(()=>{if(!t(d)||!e.onVisibilityChange)return;const c=new IntersectionObserver(([I])=>{e.onVisibilityChange(I.isIntersecting)},{threshold:0});return c.observe(t(d)),()=>{c.disconnect()}});const b=n(()=>({href:Ue("/board"),label:"法人トップ",isActive:r().url.pathname==="/board",isDisabled:!1})),x=c=>{const I=c.disabled||c.slug!=="kyoritsu";return{href:Ue(`/board/${c.slug}`),label:c.shortName,isActive:!1,isDisabled:I}},v=n(()=>Mt.map(c=>x(c))),_=n(()=>[t(b),...t(v)]);var p=Yt(),h=O(p),g=i(h),D=i(g);Rt(D,{class:"text-secondary size-6"}),a(g);var T=m(g,2),P=i(T),A=m(i(P),2);Ye(A,()=>t(_)),a(P),Re(2),a(T);var S=m(T,2);et(S,c=>N(d,c),()=>t(d)),a(h);var y=m(h,2);qe(y,{onOpenChange:c=>{c||N(s,!1)},title:"メニュー",variant:"fit",get open(){return t(s)},set open(c){N(s,c,!0)},children:(c,I)=>{Ye(c,()=>t(_),()=>()=>N(s,!1))},$$slots:{default:!0}}),j("click",g,()=>N(s,!0)),u(o,p),te(),f()}ve(["click"]);const Kt=["http:","https:","tel:","mailto:"];function Wt(o){try{const e=new URL(o);return Kt.includes(e.protocol)}catch{return!1}}var Xt=M("<button><div><div><span> </span></div> <h3> </h3></div></button>");function Ke(o,e){ee(e,!0);let r=le(e,"variant",3,"desktop"),l=ne(!1);const f=n(()=>Pt()==="dark"),s=n(()=>{const v=t(f)?"dark":"light";return{background:e.button.colors.background[v],hover:e.button.colors.hover[v],border:e.button.colors.border[v],text:e.button.colors.text[v]}}),d=n(()=>{const v=t(l)?t(s).hover:t(s).border;return t(l)?v:`color-mix(in srgb, ${v} 66%, transparent)`});function b(v){if(!(typeof window>"u")){if(!Wt(v)){bt.error(`[Security] Invalid URL scheme blocked: ${v}`);return}window.open(v,"_blank","noopener,noreferrer")}}function x(){b(e.button.url),e.onActivated?.()}{const v=(p,h=Me)=>{const g=n(()=>r()==="desktop");var D=Xt();Ge(D,()=>({...h(),type:"button","data-testid":`action-button-${e.button.id??""}`,class:"card-base press-feedback cursor-pointer border-[0.5px] transition-all hover:shadow-md",[mt]:{"border-color":t(d)}}));var T=i(D),P=i(T);let A;var S=i(P);let y;var c=i(S,!0);a(S),a(P);var I=m(P,2);let R;var F=i(I,!0);a(I),a(T),a(D),V(()=>{X(T,1,Se(t(g)?"flex h-full flex-row items-center gap-2 px-3 py-2":"flex h-full flex-col items-center justify-center gap-2 p-4")),X(P,1,Se(t(g)?"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-md":"flex h-12 w-12 items-center justify-center rounded-full")),A=Ie(P,"",A,{"background-color":t(s).background}),X(S,1,Se(t(g)?"material-symbols-outlined pointer-events-none text-sm":"material-symbols-outlined icon-2xl pointer-events-none")),y=Ie(S,"",y,{color:t(s).border}),z(c,e.button.icon),X(I,1,Se(t(g)?"flex-1 text-center text-sm leading-tight font-medium text-slate-700 dark:text-slate-200":"text-md text-center leading-tight font-medium")),R=Ie(I,"",R,{color:t(g)?void 0:t(s).text}),z(F,e.button.title)}),u(p,D)};let _=n(()=>({"aria-label":e.button.title,onclick:x,onmouseenter:()=>N(l,!0),onmouseleave:()=>N(l,!1)}));Fe(o,{text:"クリックして表示",get triggerProps(){return t(_)},trigger:v,$$slots:{trigger:!0}})}te()}var Jt=M('<button type="button"> </button>');function Pe(o,e){ee(e,!0);const r=le(e,"active",3,!1),l=le(e,"disabled",3,!1),f=le(e,"compact",3,!1),s="flex items-center justify-center rounded-lg border transition-colors disabled:cursor-not-allowed disabled:opacity-40",d="border-default bg-card hover-bg-moderate",b="border-red-500 bg-red-50 text-red-700 hover:bg-red-100 dark:border-red-400 dark:bg-red-900/30 dark:text-red-300 dark:hover:bg-red-900/50",x=n(()=>[s,r()?b:d,f()?"min-h-[36px] px-3 py-1.5 text-xs font-semibold":"min-h-[44px] px-3 py-2 text-xs font-semibold md:px-4 md:text-sm"].join(" "));var v=Jt(),_=i(v,!0);a(v),V(()=>{v.disabled=l(),X(v,1,Se(t(x))),Z(v,"aria-label",e.ariaLabel),Z(v,"aria-pressed",r()),z(_,e.label)}),j("click",v,function(...p){e.onclick?.apply(this,p)}),u(o,v),te()}ve(["click"]);var qt=M("<button><!></button>");function We(o,e){ee(e,!0);const r=le(e,"disabled",3,!1),l=le(e,"compact",3,!1),f=n(()=>e.direction==="prev"),s=n(()=>t(f)?"前日":"翌日"),d=n(()=>t(f)?At:Et),b=n(()=>["inline-flex items-center justify-center rounded-lg transition-colors","disabled:cursor-not-allowed disabled:opacity-40","border border-default bg-card hover-bg-moderate",l()?"p-1.5":"p-3"].join(" ")),x=n(()=>(l(),"size-5"));{const v=(p,h=Me)=>{var g=qt();Ge(g,()=>({...h(),type:"button",class:t(b)}));var D=i(g);fe(D,()=>t(d),(T,P)=>{P(T,{class:t(x)})}),a(g),u(p,g)};let _=n(()=>({onclick:e.onclick,disabled:r(),"aria-label":`${t(s)}のデータを表示`}));Fe(o,{get text(){return t(s)},zIndex:"z-[70]",get triggerProps(){return t(_)},trigger:v,$$slots:{trigger:!0}})}te()}var Qt=M("<button> </button>");function Zt(o,e){const r=le(e,"compact",3,!1),l=n(()=>r()?"text-primary rounded-lg px-2 py-1 text-center text-base leading-tight font-bold whitespace-nowrap transition-colors hover-bg-moderate":"text-primary rounded-lg px-2 py-1 text-center text-sm leading-tight font-bold whitespace-nowrap transition-colors hover-bg-moderate md:text-lg");{const f=(d,b=Me)=>{var x=Qt();Ge(x,()=>({...b(),type:"button",class:t(l)}));var v=i(x,!0);a(x),V(()=>z(v,e.date??"—")),u(d,x)};let s=n(()=>({onclick:e.onclick,"aria-label":"日付を選択"}));Fe(o,{text:"日付を選択",zIndex:"z-[70]",get triggerProps(){return t(s)},trigger:f,$$slots:{trigger:!0}})}}var $t=M("<div><!> <!> <!></div> <!>",1);function nt(o,e){const r=le(e,"compact",3,!1);let l=ne(!1);var f=$t(),s=O(f),d=i(s);{let _=n(()=>!e.canGoPrevious);We(d,{direction:"prev",get disabled(){return t(_)},get compact(){return r()},get onclick(){return e.onPreviousDate}})}var b=m(d,2);Zt(b,{get date(){return e.dataDate},get compact(){return r()},onclick:()=>N(l,!0)});var x=m(b,2);{let _=n(()=>!e.canGoNext);We(x,{direction:"next",get disabled(){return t(_)},get compact(){return r()},get onclick(){return e.onNextDate}})}a(s);var v=m(s,2);gt(v,{get dashboardData(){return e.dashboardData},get currentDateIndex(){return e.currentDateIndex},get onDateSelect(){return e.onDateSelect},get open(){return t(l)},set open(_){N(l,_,!0)}}),V(()=>X(s,1,`flex w-full items-center justify-center ${r()?"gap-2":"gap-1 md:gap-3"}`)),u(o,f)}var ea=M('<span class="font-semibold"> </span> <!>',1),ta=M("<!> <!>",1),aa=M('<div class="hidden items-center justify-end md:flex"><!></div>'),ra=M('<nav class="bottom-nav-bar"><div class="flex w-full items-center gap-2 md:grid md:grid-cols-3"><div class="flex shrink-0 items-center justify-start gap-1" role="group" aria-label="日付クイックジャンプ"><!> <!></div> <div class="min-w-0 flex-1"><!></div> <!></div></nav>');function ia(o,e){ee(e,!0);var r=ra(),l=i(r),f=i(l),s=i(f);{let p=n(()=>!e.canGoToYesterday);Pe(s,{label:"前日",ariaLabel:"前日のデータにジャンプ",get active(){return e.isShowingYesterday},get disabled(){return t(p)},get onclick(){return e.onYesterdayDate}})}var d=m(s,2);{let p=n(()=>!e.canGoToToday);Pe(d,{label:"当日",ariaLabel:"当日のデータにジャンプ",get active(){return e.isShowingToday},get disabled(){return t(p)},get onclick(){return e.onTodayDate}})}a(f);var b=m(f,2),x=i(b);nt(x,{get dataDate(){return e.dataDate},get canGoPrevious(){return e.canGoPrevious},get canGoNext(){return e.canGoNext},get onPreviousDate(){return e.onPreviousDate},get onNextDate(){return e.onNextDate},get dashboardData(){return e.dashboardData},get currentDateIndex(){return e.currentDateIndex},get onDateSelect(){return e.onDateSelect}}),a(b);var v=m(b,2);{var _=p=>{var h=aa(),g=i(h);ge(g,{children:(D,T)=>{var P=ta(),A=O(P);fe(A,()=>ge.Trigger,(y,c)=>{c(y,{class:"border-default bg-card hover-bg-moderate flex min-h-[44px] items-center justify-center gap-2 rounded-lg border px-4 py-2 text-sm transition-colors","aria-label":"グラフ表示期間を選択",children:(I,R)=>{var F=ea(),J=O(F),q=i(J);a(J);var re=m(J,2);Be(re,{size:18,strokeWidth:2.5}),V(()=>z(q,`グラフ期間（${e.period??""}日間）`)),u(I,F)},$$slots:{default:!0}})});var S=m(A,2);Qe(S,{children:(y,c)=>{var I=$(),R=O(I);fe(R,()=>ge.Positioner,(F,J)=>{J(F,{children:(q,re)=>{var ie=$(),se=O(ie);fe(se,()=>ge.Content,(me,ce)=>{ce(me,{class:"menu-dropdown",children:(ue,ae)=>{var Y=$(),C=O(Y);de(C,16,()=>Ne,k=>k,(k,L)=>{var w=$(),H=O(w);{let K=n(()=>String(L)),G=n(()=>L===e.period?"menu-dropdown-item-active":"");fe(H,()=>ge.Item,(B,E)=>{E(B,{get value(){return t(K)},onclick:()=>e.onPeriodChange(L),get class(){return`focus-ring-blue menu-dropdown-item ${t(G)??""}`},children:(W,Q)=>{var oe=$(),pe=O(oe);fe(pe,()=>ge.ItemText,(ye,he)=>{he(ye,{class:"text-primary font-medium",children:(xe,vr)=>{Re();var Oe=Xe();V(()=>z(Oe,`${L??""}日間`)),u(xe,Oe)},$$slots:{default:!0}})}),u(W,oe)},$$slots:{default:!0}})})}u(k,w)}),u(ue,Y)},$$slots:{default:!0}})}),u(q,ie)},$$slots:{default:!0}})}),u(y,I)},$$slots:{default:!0}}),u(D,P)},$$slots:{default:!0}}),a(h),u(p,h)};U(v,p=>{e.period!==void 0&&e.onPeriodChange&&p(_)})}a(l),a(r),u(o,r),te()}var na=M('<span class="text-tertiary text-sm whitespace-nowrap">指標を選択してください</span>'),la=M('<div class="border-divider bg-surface-secondary inline-flex flex-shrink-0 items-center gap-1.5 rounded-md border px-2.5 py-1.5"><span class="text-primary max-w-[160px] truncate text-sm leading-tight font-medium"> </span> <button type="button" class="focus-ring-blue hover-bg-moderate -my-0.5 -mr-0.5 flex items-center justify-center rounded p-0.5 transition-colors"><span class="material-symbols-outlined text-tertiary text-[13px]">close</span></button></div>'),sa=M('<button type="button" class="focus-ring-blue hover-bg-moderate rounded p-1 transition-colors" aria-label="全選択をクリア"><span class="material-symbols-outlined text-tertiary text-[15px] leading-none">close</span></button>'),oa=M('<div class="border-divider bg-card flex min-h-[40px] flex-1 items-center gap-2 rounded-lg border px-3 py-1.5"><div class="flex flex-1 items-center gap-2 overflow-x-auto [scrollbar-width:none]"><!></div> <div class="border-divider flex flex-shrink-0 items-center gap-2 border-l pl-3"><span class="badge-counter-blue tabular-nums"> </span> <!></div></div>');function da(o,e){ee(e,!0);function r(g){return e.metrics.find(D=>D.id===g)?.title??g}var l=oa(),f=i(l),s=i(f);{var d=g=>{var D=na();u(g,D)},b=g=>{var D=$(),T=O(D);de(T,16,()=>e.comparedMetricIds,P=>P,(P,A)=>{const S=n(()=>r(A));var y=la(),c=i(y),I=i(c,!0);a(c);var R=m(c,2);a(y),V(()=>{z(I,t(S)),Z(R,"aria-label",`${t(S)??""}を選択解除`)}),j("click",R,()=>e.onRemove(A)),Dt(3,y,()=>kt,()=>({duration:150,start:.9})),u(P,y)}),u(g,D)};U(s,g=>{e.comparedMetricIds.length===0?g(d):g(b,!1)})}a(f);var x=m(f,2),v=i(x),_=i(v);a(v);var p=m(v,2);{var h=g=>{var D=sa();j("click",D,function(...T){e.onClearAll?.apply(this,T)}),u(g,D)};U(p,g=>{e.comparedMetricIds.length>0&&g(h)})}a(x),a(l),V(()=>z(_,`${e.comparedMetricIds.length??""}/${e.maxComparedMetrics??""}`)),u(o,l),te()}ve(["click"]);var ca=M('<span class="badge-pill-stone inline-flex items-center gap-1 whitespace-nowrap"><span class="material-symbols-outlined text-[14px]">schedule</span> </span>'),ua=M('<span class="flex flex-col items-center leading-tight"><span class="text-secondary text-[10px]">グラフ表示期間</span> <span class="badge-pill-stone mt-0.5 text-[10px]"> </span></span> <!>',1),va=M("<!> <!>",1),ga=M('<div class="bg-page border-divider border-b px-4 py-2 md:flex md:items-center md:justify-between md:gap-4 md:px-8"><!> <div class="flex flex-shrink-0 items-center gap-3"><!> <!></div></div>');function ma(o,e){ee(e,!0);const r=n(()=>e.compare.comparedMetricIds),l=n(()=>e.compare.maxComparedMetrics),f=n(()=>e.compare.onToggleComparedMetric),s=n(()=>e.compare.onClearComparedMetrics);var d=ga(),b=i(d);da(b,{get metrics(){return e.metrics},get comparedMetricIds(){return t(r)},get maxComparedMetrics(){return t(l)},get onRemove(){return t(f)},get onClearAll(){return t(s)}});var x=m(b,2),v=i(x);{var _=h=>{var g=ca(),D=m(i(g));a(g),V(()=>z(D,` ${e.lastUpdatedText??""}`)),u(h,g)};U(v,h=>{e.lastUpdatedText&&h(_)})}var p=m(v,2);ge(p,{children:(h,g)=>{var D=va(),T=O(D);fe(T,()=>ge.Trigger,(A,S)=>{S(A,{class:"border-default bg-card hover-bg-moderate flex min-h-[36px] items-center justify-center gap-1 rounded-lg border px-2.5 py-1.5 text-sm transition-colors disabled:cursor-not-allowed disabled:opacity-40","aria-label":"グラフ表示期間を選択",children:(y,c)=>{var I=ua(),R=O(I),F=m(i(R),2),J=i(F);a(F),a(R);var q=m(R,2);Be(q,{size:14,strokeWidth:2.5,class:"flex-shrink-0"}),V(()=>z(J,`${e.periodProps.period??""}日間`)),u(y,I)},$$slots:{default:!0}})});var P=m(T,2);Qe(P,{children:(A,S)=>{var y=$(),c=O(y);fe(c,()=>ge.Positioner,(I,R)=>{R(I,{children:(F,J)=>{var q=$(),re=O(q);fe(re,()=>ge.Content,(ie,se)=>{se(ie,{class:"menu-dropdown",children:(me,ce)=>{var ue=$(),ae=O(ue);de(ae,16,()=>Ne,Y=>Y,(Y,C)=>{var k=$(),L=O(k);{let w=n(()=>String(C)),H=n(()=>C===e.periodProps.period?"menu-dropdown-item-active":"");fe(L,()=>ge.Item,(K,G)=>{G(K,{get value(){return t(w)},onclick:()=>e.periodProps.onPeriodChange(C),get class(){return`focus-ring-blue menu-dropdown-item ${t(H)??""}`},children:(B,E)=>{var W=$(),Q=O(W);fe(Q,()=>ge.ItemText,(oe,pe)=>{pe(oe,{class:"text-primary font-medium",children:(ye,he)=>{Re();var xe=Xe();V(()=>z(xe,`${C??""}日間`)),u(ye,xe)},$$slots:{default:!0}})}),u(B,W)},$$slots:{default:!0}})})}u(Y,k)}),u(me,ue)},$$slots:{default:!0}})}),u(F,q)},$$slots:{default:!0}})}),u(A,y)},$$slots:{default:!0}}),u(h,D)},$$slots:{default:!0}}),a(x),a(d),u(o,d),te()}function fa(o){const{metricId:e,selectedMetricId:r,highlightedMetricId:l,isDevMode:f=!1}=o,s=["card-base","focus-ring-blue"];return r===e?s.push("card-selected"):s.push("hover-bg-subtle"),l===e&&s.push("metric-highlight"),f&&s.push("ring-2","ring-amber-400","dark:ring-amber-500"),s.join(" ")}function ba(o){return o?"ring-2 ring-amber-400 dark:ring-amber-500":""}function lt(o,e,r){const l=e.includes(o);return{isChecked:l,isDisabled:r&&!l}}function Ae(o,e){return o.find(r=>r.dataKey===e)}function ha(o,e){return e.map(r=>Ae(o,r)).filter(r=>r!==void 0)}function xa(o,e,r){const l=e.find(f=>f.id===o);if(l)return Ae(r,l.dataKey)}function pa(o,e){return o.map(r=>e.find(l=>l.id===r)?.dataKey).filter(r=>r!==void 0)}function ya(o,e){return e.find(r=>r.dataKey===o)}var _a=M('<div class="grid grid-cols-1 gap-4 md:grid-cols-2"></div>'),Ma=M('<div class="flex w-full flex-col gap-4 py-20"><p class="text-primary text-center text-base font-medium">データ読み込み中</p></div>'),Da=M('<div role="button" tabindex="0"><!></div>'),ka=M('<div class="flex flex-col gap-2" role="list" aria-label="指標一覧"></div>'),Ca=M('<button type="button" class="border-default bg-surface-secondary hover-bg-moderate flex w-6 flex-shrink-0 cursor-pointer flex-col items-center justify-center gap-2 border-r transition-colors" aria-label="指標パネルを表示"><span class="material-symbols-outlined text-tertiary text-base transition-colors hover:text-slate-600 dark:hover:text-gray-300">chevron_right</span></button>'),Sa=M('<button type="button" class="btn-danger">再取得</button>'),Ia=M('<div class="hidden h-full md:flex md:flex-col"><!> <div class="flex h-full flex-1 overflow-hidden"><div class="flex-shrink-0 overflow-hidden transition-[width] duration-300 ease-in-out"><aside class="flex h-full flex-col" aria-label="指標選択パネル"><div class="flex-shrink-0 px-8 py-3"><div class="mb-3 flex items-center justify-center gap-2"><button type="button" class="focus-ring-blue hover-bg-moderate flex items-center gap-1 rounded-lg px-2 py-1.5 text-sm font-medium transition-colors" aria-label="指標を非表示"><span class="material-symbols-outlined text-[18px]">chevron_left</span> <span class="text-secondary text-xs whitespace-nowrap">指標を非表示</span></button> <div class="bg-divider h-5 w-px"></div> <!> <!></div> <!></div> <div class="flex-1 overflow-y-auto" style="scrollbar-gutter: stable;"><div class="py-4 pr-4 pl-8"><!></div></div></aside></div> <!> <section class="min-w-0 flex-1 overflow-y-auto py-6 pr-8 pl-4" aria-label="グラフ表示エリア"><!></section></div></div>');function wa(o,e){ee(e,!0);const r=(C,k=Me)=>{var L=$(),w=O(L);{var H=G=>{Te(G,_e({get graph(){return k()[0]}},()=>t(d)))},K=G=>{var B=_a();de(B,21,k,E=>E.id,(E,W)=>{const Q=n(()=>ya(t(W).dataKey,e.metrics.filteredMetrics));var oe=$(),pe=O(oe);{var ye=he=>{Te(he,_e({get graph(){return t(W)}},()=>t(d),{class:"h-[320px] p-3 md:h-[360px]",compact:!0,idSuffix:"-multi",onClose:()=>t(s)(t(Q).id)}))};U(pe,he=>{t(Q)&&he(ye)})}u(E,oe)}),a(B),u(G,B)};U(w,G=>{k().length===1?G(H):G(K,!1)})}u(C,L)},l=n(()=>e.compare.comparedMetricIds),f=n(()=>e.compare.isCompareMaxed),s=n(()=>e.compare.onToggleComparedMetric),d=n(()=>({data:e.graph.dashboardData??[],period:e.graph.period,date:e.graph.date}));var b=Ia(),x=i(b);ma(x,{get lastUpdatedText(){return e.viewState.lastUpdatedText},get metrics(){return e.metrics.filteredMetrics},get compare(){return e.compare},get periodProps(){return e.periodProps}});var v=m(x,2),_=i(v),p=i(_),h=i(p),g=i(h),D=i(g),T=m(D,4);{let C=n(()=>!e.navigation.canGoToYesterday);Pe(T,{label:"前日",ariaLabel:"前日のデータにジャンプ",get active(){return e.navigation.isShowingYesterday},get disabled(){return t(C)},compact:!0,get onclick(){return e.navigation.onYesterdayDate}})}var P=m(T,2);{let C=n(()=>!e.navigation.canGoToToday);Pe(P,{label:"当日",ariaLabel:"当日のデータにジャンプ",get active(){return e.navigation.isShowingToday},get disabled(){return t(C)},compact:!0,get onclick(){return e.navigation.onTodayDate}})}a(g);var A=m(g,2);nt(A,{get dataDate(){return e.navigation.dataDate},get canGoPrevious(){return e.navigation.canGoPrevious},get canGoNext(){return e.navigation.canGoNext},get onPreviousDate(){return e.navigation.onPreviousDate},get onNextDate(){return e.navigation.onNextDate},get dashboardData(){return e.graph.dashboardData},get currentDateIndex(){return e.selectedDateIndex},get onDateSelect(){return e.navigation.onDateSelect},compact:!0}),a(h);var S=m(h,2),y=i(S),c=i(y);{var I=C=>{var k=Ma();u(C,k)},R=C=>{var k=ka();de(k,21,()=>e.metrics.filteredMetrics,L=>L.id,(L,w)=>{const H=n(()=>fa({metricId:t(w).id,selectedMetricId:e.metrics.selectedMetricId,highlightedMetricId:e.metrics.highlightedMetricId,isDevMode:t(w).isDev})),K=n(()=>lt(t(w).id,t(l),t(f))),G=n(()=>rt(t(w),e.metrics.displayData)),B=n(()=>!e.viewState.hasDataForSelectedDate);var E=Da(),W=i(E);{let Q=n(()=>t(w).isDev?"dev":"default"),oe=n(()=>t(w).isDev?tt(t(w),e.metrics.displayData):void 0);at(W,{get title(){return t(w).title},get value(){return t(G)},get isChecked(){return t(K).isChecked},get isDisabled(){return t(K).isDisabled},onCheckboxClick:()=>t(s)(t(w).id),listVariant:"desktop",get variant(){return t(Q)},get devInfo(){return t(oe)}})}a(E),V(()=>{X(E,1,`interactive-card-list ${t(H)??""} ${t(B)?"opacity-50 grayscale":""}`),Z(E,"aria-label",`${t(w).title??""}を選択、現在の値: ${t(G)??""}`),Z(E,"aria-pressed",e.metrics.selectedMetricId===t(w).id)}),j("click",E,()=>e.callbacks.onMetricSelect(t(w).id)),j("keydown",E,Q=>{(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),e.callbacks.onMetricSelect(t(w).id))}),u(L,E)}),a(k),u(C,k)};U(c,C=>{e.viewState.isLoading&&!e.viewState.hasData?C(I):C(R,!1)})}a(y),a(S),a(p),a(_);var F=m(_,2);{var J=C=>{var k=Ca();j("click",k,function(...L){e.callbacks.onToggleMetricsPanel?.apply(this,L)}),u(C,k)};U(F,C=>{e.viewState.isMetricsPanelVisible||C(J)})}var q=m(F,2),re=i(q);{var ie=C=>{be(C,{variant:"empty",title:"データがありません",message:"選択した日付のデータが存在しません。別の日付を選択してください。"})},se=C=>{be(C,{variant:"error",title:"エラーが発生しました",get message(){return e.desktopDisplayState.message},children:(k,L)=>{var w=Sa();j("click",w,function(...H){e.callbacks.onRetry?.apply(this,H)}),u(k,w)},$$slots:{default:!0}})},me=C=>{be(C,{variant:"loading",title:"読み込み中",message:"データを取得しています…"})},ce=C=>{be(C,{variant:"empty",title:"データがありません",message:"期間や更新状況を確認してください。"})},ue=C=>{be(C,{variant:"info",title:"指標を選択",message:"左の指標を選択してグラフを表示します。"})},ae=C=>{Te(C,_e({get graph(){return e.desktopDisplayState.graph}},()=>t(d)))},Y=C=>{r(C,()=>e.desktopDisplayState.graphs)};U(re,C=>{e.viewState.hasDataForSelectedDate?e.desktopDisplayState.type==="error"?C(se,1):e.desktopDisplayState.type==="loading"?C(me,2):e.desktopDisplayState.type==="empty"?C(ce,3):e.desktopDisplayState.type==="no-selection"?C(ue,4):e.desktopDisplayState.type==="single-graph"?C(ae,5):e.desktopDisplayState.type==="multi-graph"&&C(Y,6):C(ie)})}a(q),a(v),a(b),V(()=>{Ie(_,`width: ${(e.viewState.isMetricsPanelVisible?ze.METRICS_PANEL_WIDTH:0)??""}px;`),Z(_,"aria-hidden",!e.viewState.isMetricsPanelVisible),_.inert=!e.viewState.isMetricsPanelVisible,Ie(p,`width: ${ze.METRICS_PANEL_WIDTH}px;`),Z(D,"aria-expanded",e.viewState.isMetricsPanelVisible)}),j("click",D,function(...C){e.callbacks.onToggleMetricsPanel?.apply(this,C)}),u(o,b),te()}ve(["click","keydown"]);var Ta=M('<span class="material-symbols-outlined flex-shrink-0 text-[20px]"> </span>'),Pa=M('<button type="button" class="btn-danger">再取得</button>'),Aa=M('<div role="region" class="mt-2"><!></div>'),Ea=M('<div><div role="button" tabindex="0"><!></div> <!></div>');function Ra(o,e){ee(e,!0);let r=le(e,"isHighlighted",3,!1),l=le(e,"devMode",3,!1),f=le(e,"displayData",3,null),s=ne(null);const d=n(()=>`accordion-content-${e.metric.id}`);Ce(()=>{e.onRefChange(t(s))});var b=Ea(),x=i(b),v=i(x);{const h=T=>{var P=Ta(),A=i(P,!0);a(P),V(()=>z(A,e.isExpanded?"expand_less":"expand_more")),u(T,P)};let g=n(()=>l()?"dev":"default"),D=n(()=>l()?tt(e.metric,f()):void 0);at(v,{get title(){return e.metric.title},get value(){return e.metricValue},get isChecked(){return e.isChecked},get isDisabled(){return e.isDisabled},get onCheckboxClick(){return e.onCheckboxClick},listVariant:"mobile",get variant(){return t(g)},get devInfo(){return t(D)},trailing:h,$$slots:{trailing:!0}})}a(x);var _=m(x,2);{var p=h=>{var g=Aa(),D=i(g);{var T=c=>{be(c,{variant:"error",title:"エラーが発生しました",get message(){return e.error.message},children:(I,R)=>{var F=Pa();j("click",F,function(...J){e.onRetry?.apply(this,J)}),u(I,F)},$$slots:{default:!0}})},P=c=>{be(c,{variant:"loading",title:"読み込み中",message:"データを取得しています…"})},A=c=>{be(c,{variant:"empty",title:"データがありません",message:"期間や更新状況を確認してください。"})},S=c=>{Te(c,{get graph(){return e.graph},get data(){return e.data},get period(){return e.period},get date(){return e.date}})},y=c=>{be(c,{variant:"info",title:"グラフがありません",message:"この指標のグラフは設定されていません。"})};U(D,c=>{e.error&&(!e.data||e.data.length===0)?c(T):e.isLoading&&(!e.data||e.data.length===0)?c(P,1):e.data&&e.data.length===0?c(A,2):e.graph&&e.data&&e.data.length>0?c(S,3):c(y,!1)})}a(g),V(()=>{Z(g,"id",t(d)),Z(g,"aria-label",`${e.metric.title??""}のグラフ`)}),u(h,g)};U(_,h=>{e.isExpanded&&h(p)})}a(b),et(b,h=>N(s,h),()=>t(s)),V(h=>{X(b,1,`w-full ${r()?"mobile-accordion-highlight":""}`),X(x,1,`interactive-card-list ${h??""}`),Z(x,"aria-label",e.isExpanded?`${e.metric.title}を閉じる`:`${e.metric.title}を開く`),Z(x,"aria-expanded",e.isExpanded),Z(x,"aria-controls",t(d))},[()=>ba(l())]),j("click",x,function(...h){e.onToggle?.apply(this,h)}),j("keydown",x,h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),e.onToggle())}),u(o,b),te()}ve(["click","keydown"]);var La=M('<div class="border-l-4 border-slate-300 bg-slate-50 p-3 text-sm text-slate-600 dark:border-slate-600 dark:bg-slate-800/50 dark:text-slate-400" role="status">選択した日付のデータが存在しません。別の日付を選択してください。</div>'),Va=M('<div class="pb-footer-clearance flex-1 overflow-y-auto"><!> <div class="bg-page border-divider sticky top-0 z-[5] border-b px-4 py-3"><div class="flex items-center justify-between gap-2"><div class="flex"><button type="button" class="btn-group-left" aria-label="全指標のグラフを閉じる"><span class="material-symbols-outlined text-[16px]">unfold_less</span> <span>グラフを閉じる</span></button> <button type="button" class="btn-group-right" aria-label="全指標のグラフを開く"><span class="material-symbols-outlined text-[16px]">unfold_more</span> <span>グラフを開く</span></button></div> <button type="button" class="btn-secondary gap-1.5" aria-label="グラフ表示期間を選択"><div class="flex flex-col items-start leading-tight"><span class="font-semibold">グラフ期間</span> <span class="font-semibold"> </span></div> <!></button></div></div> <div></div></div>'),Ga=M('<div class="grid grid-cols-1 gap-4"></div>'),Na=M('<div class="flex h-full items-center justify-center"><div class="text-center"><p class="text-secondary text-sm">比較する指標が選択されていません</p></div></div>'),ja=M('<div class="flex flex-col"><div class="pb-footer-clearance flex-1 overflow-y-auto px-4 py-4"><!></div></div>'),Ba=M('<section class="flex h-full flex-col overflow-hidden md:hidden" aria-label="データタブ（モバイル）"><!></section>');function Fa(o,e){ee(e,!0);const r=n(()=>e.viewState.isLoading),l=n(()=>e.viewState.error),f=n(()=>e.viewState.hasDataForSelectedDate),s=n(()=>e.viewState.highlightedMetricId),d=n(()=>e.metrics.filteredMetrics),b=n(()=>e.metrics.displayData),x=n(()=>e.graph.graphs),v=n(()=>e.graph.dashboardData),_=n(()=>e.graph.period),p=n(()=>e.graph.date),h=n(()=>e.callbacks.onExpandAllMetrics),g=n(()=>e.callbacks.onCollapseAllMetrics),D=n(()=>e.callbacks.onMetricCardRefChange),T=n(()=>e.callbacks.onExpandMetricsMap),P=n(()=>e.callbacks.onPeriodSheetOpen),A=n(()=>e.callbacks.onRetry),S=n(()=>e.compare.comparedMetricIds),y=n(()=>e.compare.isCompareMaxed),c=n(()=>e.compare.isCompareGraphsVisible),I=n(()=>e.compare.onToggleComparedMetric);var R=Ba(),F=i(R);{var J=re=>{var ie=Va(),se=i(ie);{var me=B=>{var E=La();u(B,E)};U(se,B=>{t(f)||B(me)})}var ce=m(se,2),ue=i(ce),ae=i(ue),Y=i(ae),C=m(Y,2);a(ae);var k=m(ae,2),L=i(k),w=m(i(L),2),H=i(w);a(w),a(L);var K=m(L,2);Be(K,{size:16,strokeWidth:2.5}),a(k),a(ue),a(ce);var G=m(ce,2);de(G,21,()=>t(d),B=>B.id,(B,E)=>{const W=n(()=>lt(t(E).id,t(S),t(y)));{let Q=n(()=>e.expandedMetricsMap[t(E).id]??!1),oe=n(()=>rt(t(E),t(b))),pe=n(()=>Ae(t(x),t(E).dataKey)),ye=n(()=>t(s)===t(E).id),he=n(()=>t(E).isDev||!1);Ra(B,{get metric(){return t(E)},get isExpanded(){return t(Q)},get metricValue(){return t(oe)},get isChecked(){return t(W).isChecked},get isDisabled(){return t(W).isDisabled},get graph(){return t(pe)},get data(){return t(v)},get period(){return t(_)},get date(){return t(p)},get error(){return t(l)},get isLoading(){return t(r)},onToggle:()=>{const xe=!e.expandedMetricsMap[t(E).id];t(T)(t(E).id,xe)},onCheckboxClick:()=>t(I)(t(E).id),get onRetry(){return t(A)},onRefChange:xe=>t(D)(t(E).id,xe),get isHighlighted(){return t(ye)},get devMode(){return t(he)},get displayData(){return t(b)}})}}),a(G),a(ie),V(()=>{z(H,`（${t(_)??""}日間）`),X(G,1,`flex w-full flex-col gap-3 px-4 py-4 ${t(f)?"":"opacity-50 grayscale"}`)}),j("click",Y,function(...B){t(g)?.apply(this,B)}),j("click",C,function(...B){t(h)?.apply(this,B)}),j("click",k,function(...B){t(P)?.apply(this,B)}),u(re,ie)},q=re=>{var ie=ja(),se=i(ie),me=i(se);{var ce=ae=>{var Y=Ga();de(Y,20,()=>t(S),C=>C,(C,k)=>{const L=n(()=>xa(k,t(d),t(x)));var w=$(),H=O(w);{var K=G=>{Te(G,{get graph(){return t(L)},get data(){return t(v)},get period(){return t(_)},get date(){return t(p)},class:"h-[320px] p-3",compact:!0,idSuffix:"-compare",onClose:()=>t(I)(k)})};U(H,G=>{t(L)&&t(v)&&t(v).length>0&&G(K)})}u(C,w)}),a(Y),u(ae,Y)},ue=ae=>{var Y=Na();u(ae,Y)};U(me,ae=>{t(S).length>0?ae(ce):ae(ue,!1)})}a(se),a(ie),u(re,ie)};U(F,re=>{t(c)?re(q,!1):re(J)})}a(R),u(o,R),te()}ve(["click"]);function Oa(o){let e=Ee({});function r(s,d){e[s]=d;const{onMetricSelect:b}=o();d&&b(s)}function l(){const{metrics:s}=o();s.forEach(d=>{e[d.id]=!0})}function f(){const{metrics:s}=o();s.forEach(d=>{e[d.id]=!1})}return Ce(()=>{const{selectedMetricId:s}=o();s&&(e[s]=!0)}),{get expandedMetricsMap(){return e},handleExpand:r,expandAll:l,collapseAll:f}}function Ha(o){let e=Ee({}),r=null;function l(d,b){e[d]=b}function f(){r!=null&&(clearTimeout(r),r=null)}function s(d,b){const x=b?.block??"center";f(),r=setTimeout(()=>{r=null,e[d]?.scrollIntoView({behavior:"smooth",block:x})},xt)}return Ce(()=>{const{selectedMetricId:d}=o();return d&&s(d),()=>{f()}}),{updateRef:l,scrollToMetric:s}}function za(o){const{error:e,isLoading:r,data:l,desktopSelectedDataKeys:f,selectedMetricId:s,metrics:d,graphs:b}=o;if(r)return{type:"loading"};if(e&&(!l||l.length===0))return{type:"error",message:e.message};if(!l||l.length===0)return{type:"empty"};if(f?.length){const x=ha(b,f);if(x.length>0)return{type:"multi-graph",graphs:x}}if(s){const x=d.find(v=>v.id===s);if(x){const v=Ae(b,x.dataKey);if(v)return{type:"single-graph",graph:v}}}return{type:"no-selection"}}function Ua(o){const{isCompareGraphsVisible:e,comparedCount:r,maxComparedMetrics:l}=o;return e?{type:"compare-active",count:r,max:l}:r>0?{type:"has-selection",count:r,max:l}:{type:"empty"}}var Ya=M('<div class="flex items-center gap-2 text-white"><span class="text-sm font-medium"> </span> <span class="rounded-full bg-white/20 px-2 py-0.5 text-sm font-semibold"> </span></div>'),Ka=M('<div class="border-l-4 border-amber-400 bg-amber-50 p-2 text-sm text-amber-700 dark:bg-amber-900/20 dark:text-amber-300" role="status">データの取得に失敗しました。前回取得したデータを表示しています。</div>'),Wa=M('<button type="button"><span class="text-primary font-medium"> </span></button>'),Xa=M('<div class="flex flex-col gap-3"></div>'),Ja=M('<button type="button" class="mobile-footer-btn-back" aria-label="一覧に戻る"><span class="material-symbols-outlined">arrow_back</span> <span class="text-sm font-medium">一覧に戻る</span></button> <div class="flex-1"></div> <!>',1),qa=M('<!> <button type="button" class="mobile-footer-btn-primary" aria-label="選択した指標を比較表示"><span class="material-symbols-outlined">bar_chart</span> <span class="text-sm font-medium">比較グラフを表示</span></button>',1),Qa=M('<div class="flex w-full items-center justify-center gap-2 text-white"><span class="material-symbols-outlined text-lg">info</span> <span class="text-sm">複数の指標を選択して比較できます</span></div>'),Za=M('<section aria-label="データ" class="flex h-full flex-col"><!> <div class="md:hidden"><!></div> <div class="pb-footer-clearance flex-1 overflow-hidden"><!> <!></div> <!> <!></section>');function Hr(o,e){ee(e,!0);const r=(k,L=Me)=>{var w=Ya(),H=i(w),K=i(H);a(H);var G=m(H,2),B=i(G);a(G),a(w),V(()=>{z(K,`${L()??""}:`),z(B,`${t(f).length??""}/${we.MAX_METRICS}`)}),u(k,w)},l=Gt(),f=n(()=>l.comparedIds);let s=ne(!1),d=ne(!0);const b=n(()=>l.isCompareVisible),x=Oa(()=>({metrics:e.metricSelection.metrics,selectedMetricId:e.metricSelection.selectedMetricId,onMetricSelect:e.metricSelection.onMetricSelect})),v=Ha(()=>({selectedMetricId:e.metricSelection.selectedMetricId})),_=n(()=>l.isCompareMaxed),p=n(()=>e.metricSelection.metrics.filter(k=>It(k,e.devMode))),h=n(()=>{if(t(f).length!==0)return pa(t(f),e.metricSelection.metrics)}),g=n(()=>za({error:e.dataState.error,isLoading:e.dataState.isLoading,data:e.graphData.dashboardData,desktopSelectedDataKeys:t(h),selectedMetricId:e.metricSelection.selectedMetricId,metrics:t(p),graphs:e.graphData.graphs})),D=n(()=>e.graphData.displayData?.日付??null),T=n(()=>e.navigation.hasDataForSelectedDate),P=n(()=>Ua({isCompareGraphsVisible:t(b),comparedCount:t(f).length,maxComparedMetrics:we.MAX_METRICS})),A=n(()=>({comparedMetricIds:t(f),isCompareMaxed:t(_),maxComparedMetrics:we.MAX_METRICS,isCompareGraphsVisible:t(b),onToggleComparedMetric:k=>l.toggleCompare(k),onClearComparedMetrics:()=>l.clearCompare()}));function S(){N(d,!t(d))}function y(k){e.period.onPeriodChange(k),N(s,!1)}function c(){l.setCompareGraphsVisible(!0)}async function I(){try{await e.dataState.onRetry(),wt("取得完了","最新データを取得しました")}catch{Tt("取得失敗","データの取得に失敗しました")}}function R(){l.setCompareGraphsVisible(!1)}function F(k,L){x.handleExpand(k,L),L&&v.scrollToMetric(k)}Ce(()=>{if(!e.metricSelection.highlightedMetricId||e.metricSelection.scrollOperation==="tab")return;const k=e.metricSelection.highlightedMetricId;let L=!1;return ct().then(()=>{L||(x.handleExpand(k,!0),v.scrollToMetric(k))}),()=>{L=!0}});var J={showCompareGraphs:c,handleRetry:I},q=Za(),re=i(q);{var ie=k=>{var L=Ka();u(k,L)};U(re,k=>{e.dataState.hasStaleData&&k(ie)})}var se=m(re,2),me=i(se);ia(me,_e(()=>e.navigation,()=>e.period,{get dashboardData(){return e.graphData.dashboardData},get currentDateIndex(){return e.graphData.selectedDateIndex}})),a(se);var ce=m(se,2),ue=i(ce);{let k=n(()=>({isMetricsPanelVisible:t(d),lastUpdatedText:e.dataState.lastUpdatedText,isLoading:e.dataState.isLoading,hasData:e.dataState.hasData,hasDataForSelectedDate:t(T)})),L=n(()=>({filteredMetrics:t(p),selectedMetricId:e.metricSelection.selectedMetricId,highlightedMetricId:e.metricSelection.highlightedMetricId,displayData:e.graphData.displayData})),w=n(()=>({dashboardData:e.graphData.dashboardData,period:e.period.period,date:t(D)})),H=n(()=>({onMetricSelect:e.metricSelection.onMetricSelect,onToggleMetricsPanel:S,onRetry:I}));wa(ue,{get viewState(){return t(k)},get metrics(){return t(L)},get graph(){return t(w)},get desktopDisplayState(){return t(g)},get compare(){return t(A)},get navigation(){return e.navigation},get periodProps(){return e.period},get selectedDateIndex(){return e.graphData.selectedDateIndex},get callbacks(){return t(H)}})}var ae=m(ue,2);{let k=n(()=>({isLoading:e.dataState.isLoading,error:e.dataState.error,hasDataForSelectedDate:t(T),highlightedMetricId:e.metricSelection.highlightedMetricId})),L=n(()=>({filteredMetrics:t(p),displayData:e.graphData.displayData})),w=n(()=>({graphs:e.graphData.graphs,dashboardData:e.graphData.dashboardData,period:e.period.period,date:t(D)})),H=n(()=>({onExpandAllMetrics:x.expandAll,onCollapseAllMetrics:x.collapseAll,onMetricCardRefChange:v.updateRef,onExpandMetricsMap:F,onPeriodSheetOpen:()=>N(s,!0),onRetry:I}));Fa(ae,{get viewState(){return t(k)},get metrics(){return t(L)},get graph(){return t(w)},get compare(){return t(A)},get expandedMetricsMap(){return x.expandedMetricsMap},get callbacks(){return t(H)}})}a(ce);var Y=m(ce,2);Ct(Y,{title:"グラフ表示期間",headerBadge:"選択",get open(){return t(s)},set open(k){N(s,k,!0)},children:(k,L)=>{var w=Xa();de(w,20,()=>Ne,H=>H,(H,K)=>{var G=Wa(),B=i(G),E=i(B);a(B),a(G),V(()=>{X(G,1,`focus-ring-blue w-full rounded-lg px-4 py-3 text-left transition-colors ${K===e.period.period?"bg-blue-100 dark:bg-blue-900/40":"hover-bg-moderate"}`),z(E,`${K??""}日間`)}),j("click",G,()=>y(K)),u(H,G)}),a(w),u(k,w)},$$slots:{default:!0}});var C=m(Y,2);return St(C,{children:(k,L)=>{var w=$(),H=O(w);{var K=E=>{var W=Ja(),Q=O(W),oe=m(Q,4);r(oe,()=>"比較中"),j("click",Q,R),u(E,W)},G=E=>{var W=qa(),Q=O(W);r(Q,()=>"選択中");var oe=m(Q,2);j("click",oe,c),u(E,W)},B=E=>{var W=Qa();u(E,W)};U(H,E=>{t(P).type==="compare-active"?E(K):t(P).type==="has-selection"?E(G,1):E(B,!1)})}u(k,w)},$$slots:{default:!0}}),a(q),u(o,q),te(J)}ve(["click"]);var $a=M('<div class="grid grid-cols-2 gap-3"></div>'),er=M('<div class="card-base border-none bg-transparent shadow-none"><div class="flex flex-col"><h1 class="text-primary shrink-0 px-4 py-4 text-3xl font-medium md:py-5"> </h1> <div class="border-default border-t px-4 py-3 md:hidden"><button><span class="material-symbols-outlined text-3xl leading-none text-white drop-shadow-sm"> </span> <span class="text-base leading-none font-bold text-white drop-shadow-sm"> </span></button></div> <nav class="hidden flex-wrap gap-2 px-4 py-3 md:flex"></nav></div></div> <!>',1);function zr(o,e){ee(e,!0);let r=ne(!1);const l="border-slate-300 bg-slate-500 hover:bg-slate-600 dark:border-gray-500 dark:bg-gray-600 dark:hover:bg-gray-500",f="border-blue-300 bg-blue-500 hover:bg-blue-600 dark:border-blue-500 dark:bg-blue-600 dark:hover:bg-blue-500";function s(){N(r,!t(r))}var d=er(),b=O(d),x=i(b),v=i(x),_=i(v,!0);a(v);var p=m(v,2),h=i(p),g=i(h),D=i(g,!0);a(g);var T=m(g,2),P=i(T,!0);a(T),a(h),a(p);var A=m(p,2);de(A,21,()=>e.buttons,y=>y.id,(y,c)=>{Ke(y,{get button(){return t(c)},variant:"desktop"})}),a(A),a(x),a(b);var S=m(b,2);qe(S,{onOpenChange:y=>{y||N(r,!1)},title:"メニュー",variant:"fit",get open(){return t(r)},set open(y){N(r,y,!0)},children:(y,c)=>{var I=$a();de(I,21,()=>e.buttons,R=>R.id,(R,F)=>{Ke(R,{get button(){return t(F)},variant:"mobile",onActivated:()=>N(r,!1)})}),a(I),u(y,I)},$$slots:{default:!0}}),V(()=>{z(_,e.hospital.name),X(h,1,`press-feedback-strong group flex w-full items-center justify-center gap-2 rounded-lg border px-4 py-3 shadow-sm transition-colors ${t(r)?l:f}`),Z(h,"aria-label",t(r)?"メニューを閉じる":"メニューを開く"),z(D,t(r)?"close":"apps"),z(P,t(r)?"メニューを閉じる":"メニューを開く")}),j("click",h,s),u(o,d),te()}ve(["click"]);var tr=M('<div class="bg-page absolute inset-0 flex items-center justify-center"><div class="flex flex-col items-center gap-4 text-center"><span class="material-symbols-outlined text-4xl text-amber-500">schedule</span> <p>レポートの読み込みに時間がかかっています</p> <p class="text-secondary text-sm">接続先が応答していない可能性があります。</p> <button type="button" class="mt-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700">ページを再読み込み</button></div></div>'),ar=M('<div class="bg-page absolute inset-0 flex items-center justify-center"><div class="flex flex-col items-center gap-4 text-center"><span class="material-symbols-outlined text-4xl text-red-500">error</span> <p>レポートの読み込みに失敗しました</p> <button type="button" class="mt-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700">ページを再読み込み</button></div></div>'),rr=M('<div class="bg-page absolute inset-0 flex items-center justify-center"><div class="flex flex-col items-center gap-4"><div></div> <p>レポートを読み込み中...</p></div></div>'),ir=M('<iframe class="h-full w-full border-0"></iframe>'),nr=M('<div class="flex h-full items-center justify-center"><p>Streamlit URLが設定されていません</p></div>'),lr=M("<!> <!>",1);function sr(o,e){ee(e,!0);const r=3e4;let l=le(e,"spinnerSize",3,"lg"),f=ne(!1),s=ne(!1);const d=n(()=>l()==="lg"?"h-10 w-10 border-4":"h-8 w-8 border-4"),b=n(()=>l()==="lg"?"text-base":"text-sm");function x(){N(f,!1),N(s,!1),e.onIframeLoad()}function v(){N(s,!0)}Ce(()=>{if(!e.iframeSrc||!e.iframeLoading)return;N(f,!1),N(s,!1);const S=setTimeout(()=>{e.iframeLoading&&N(f,!0)},r);return()=>clearTimeout(S)});var _=lr(),p=O(_);{var h=S=>{var y=tr(),c=i(y),I=m(i(c),2),R=m(I,4);a(c),a(y),V(()=>X(I,1,`text-primary ${t(b)??""} font-medium`)),j("click",R,()=>location.reload()),u(S,y)},g=S=>{var y=ar(),c=i(y),I=m(i(c),2),R=m(I,2);a(c),a(y),V(()=>X(I,1,`text-primary ${t(b)??""} font-medium`)),j("click",R,()=>location.reload()),u(S,y)},D=S=>{var y=rr(),c=i(y),I=i(c),R=m(I,2);a(c),a(y),V(()=>{X(I,1,`animate-spin rounded-full border-blue-200 border-t-blue-600 ${t(d)??""}`),X(R,1,`text-secondary ${t(b)??""}`)}),u(S,y)};U(p,S=>{t(f)&&e.iframeLoading?S(h):t(s)?S(g,1):e.iframeLoading&&e.iframeSrc&&S(D,2)})}var T=m(p,2);{var P=S=>{var y=ir();V(()=>{Z(y,"src",e.iframeSrc),Z(y,"title",e.title)}),He("load",y,x),He("error",y,v),vt(y),u(S,y)},A=S=>{var y=nr(),c=i(y);a(y),V(()=>X(c,1,`text-secondary ${t(b)??""}`)),u(S,y)};U(T,S=>{e.iframeSrc?S(P):S(A,!1)})}u(o,_),te()}ve(["click"]);const st=[{value:"all",label:"すべて"},{value:"operations",label:"稼働"},{value:"patients",label:"外来・入院"},{value:"finance",label:"財務"},{value:"staff",label:"人員"}];var or=M('<label class="flex cursor-pointer items-center gap-2"><input type="radio" name="category" class="accent-primary h-4 w-4 cursor-pointer"/> <span class="text-primary text-sm"> </span></label>'),dr=M('<div class="flex h-full flex-col md:hidden"><section class="border-divider border-b px-4 py-4"><h2 class="text-primary mb-4 text-base font-medium">フィルター条件</h2> <div class="flex flex-col gap-4"><div><h3 class="text-secondary mb-2 text-xs font-medium">施設</h3> <div class="card-base bg-muted px-3 py-2"><p class="text-primary text-sm font-medium"> </p></div></div> <div><h3 class="text-secondary mb-2 text-xs font-medium">カテゴリ</h3> <div class="flex flex-col gap-2"></div></div> <div><h3 class="text-secondary mb-2 text-xs font-medium">期間</h3> <div class="flex flex-col gap-3"><div class="flex flex-col gap-1"><label for="mobile-date-from" class="text-secondary text-xs">開始日</label> <input id="mobile-date-from" type="date" class="input-base"/></div> <div class="flex flex-col gap-1"><label for="mobile-date-to" class="text-secondary text-xs">終了日</label> <input id="mobile-date-to" type="date" class="input-base"/></div></div></div> <button type="button" class="btn-secondary w-full" aria-label="フィルター条件をリセット">リセット</button></div></section> <section class="relative flex-1"><!></section></div>');function Ur(o,e){ee(e,!0);var r=dr(),l=i(r),f=m(i(l),2),s=i(f),d=m(i(s),2),b=i(d),x=i(b,!0);a(b),a(d),a(s);var v=m(s,2),_=m(i(v),2);de(_,21,()=>st,c=>c.value,(c,I)=>{var R=or(),F=i(R);De(F);var J=m(F,2),q=i(J,!0);a(J),a(R),V(()=>{ke(F,t(I).value),Ze(F,e.selectedCategory===t(I).value),z(q,t(I).label)}),j("change",F,()=>e.onCategoryChange(t(I).value)),u(c,R)}),a(_),a(v);var p=m(v,2),h=m(i(p),2),g=i(h),D=m(i(g),2);De(D),a(g);var T=m(g,2),P=m(i(T),2);De(P),a(T),a(h),a(p);var A=m(p,2);a(f),a(l);var S=m(l,2),y=i(S);sr(y,{get iframeLoading(){return e.iframeLoading},get iframeSrc(){return e.iframeSrc},get title(){return`${e.hospitalName??""}のレポート`},get onIframeLoad(){return e.onIframeLoad},spinnerSize:"sm"}),a(S),a(r),V(()=>{z(x,e.hospitalName),ke(D,e.dateFrom),ke(P,e.dateTo)}),j("input",D,c=>e.onDateFromChange(c.target.value)),j("input",P,c=>e.onDateToChange(c.target.value)),j("click",A,function(...c){e.onReset?.apply(this,c)}),u(o,r),te()}ve(["change","input","click"]);var cr=M('<label class="flex cursor-pointer items-center gap-2"><input type="radio" name="category" class="accent-primary h-4 w-4 cursor-pointer"/> <span class="text-primary text-sm"> </span></label>'),ur=M('<aside class="flex h-full flex-col gap-4 overflow-y-auto px-6 py-6" style="scrollbar-gutter: stable;" aria-label="レポートフィルター"><section aria-labelledby="filter-hospital"><h3 id="filter-hospital" class="text-primary mb-2 text-sm font-medium">施設</h3> <div class="card-base bg-muted px-3 py-2"><p class="text-primary text-sm font-medium"> </p></div></section> <section aria-labelledby="filter-category"><h3 id="filter-category" class="text-primary mb-2 text-sm font-medium">カテゴリ</h3> <div class="flex flex-col gap-2"></div></section> <section aria-labelledby="filter-period"><h3 id="filter-period" class="text-primary mb-2 text-sm font-medium">期間</h3> <div class="flex flex-col gap-3"><div class="flex flex-col gap-1"><label for="date-from" class="text-secondary text-xs">開始日</label> <input id="date-from" type="date" class="input-base"/></div> <div class="flex flex-col gap-1"><label for="date-to" class="text-secondary text-xs">終了日</label> <input id="date-to" type="date" class="input-base"/></div></div></section> <section><button type="button" class="btn-secondary w-full" aria-label="フィルター条件をリセット">リセット</button></section></aside>');function Yr(o,e){ee(e,!0);var r=ur(),l=i(r),f=m(i(l),2),s=i(f),d=i(s,!0);a(s),a(f),a(l);var b=m(l,2),x=m(i(b),2);de(x,21,()=>st,A=>A.value,(A,S)=>{var y=cr(),c=i(y);De(c);var I=m(c,2),R=i(I,!0);a(I),a(y),V(()=>{ke(c,t(S).value),Ze(c,e.selectedCategory===t(S).value),z(R,t(S).label)}),j("change",c,()=>e.onCategoryChange(t(S).value)),u(A,y)}),a(x),a(b);var v=m(b,2),_=m(i(v),2),p=i(_),h=m(i(p),2);De(h),a(p);var g=m(p,2),D=m(i(g),2);De(D),a(g),a(_),a(v);var T=m(v,2),P=i(T);a(T),a(r),V(()=>{z(d,e.hospitalName),ke(h,e.dateFrom),ke(D,e.dateTo)}),j("input",h,A=>e.onDateFromChange(A.target.value)),j("input",D,A=>e.onDateToChange(A.target.value)),j("click",P,function(...A){e.onReset?.apply(this,A)}),u(o,r),te()}ve(["change","input","click"]);export{Hr as D,zr as F,Yr as R,Br as S,Fr as T,Or as a,sr as b,Ur as c,Nr as d,jr as s};
