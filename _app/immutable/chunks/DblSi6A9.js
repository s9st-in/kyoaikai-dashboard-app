import"./DsnmJJEf.js";import{p as Pe,j as Oe,g as e,h as P,b as Me,u as p,i as ae,d as O,k as re,a as d,t as M,c as r,s as l,f as x,r as a,l as Te}from"./p4dYvpg6.js";import{s as y}from"./T2Bmc5lN.js";import{i as Ee}from"./36Dr0qmW.js";import{P as Ie,e as se}from"./CS60pbwF.js";import{p as B,c as F,W as Se}from"./OQgd7Oh0.js";import{a as A}from"./Cq4yWqvx.js";import{C as Ae,W as De,M as le,O as je,H as T}from"./BYYwbIbG.js";import"./BhIsClV-.js";import{I as Le}from"./CkzHvpIg.js";import{M as D}from"./6V6pAoJc.js";var Re=x('<div class="flex items-center gap-2"><span></span> <span class="text-secondary text-xs"> </span></div>'),He=x('<div class="space-y-1.5"><span class="text-tertiary text-[10px] font-semibold">凡例</span> <!></div>'),Ve=x("<!> <!>",1),ze=x('<span class="text-tertiary text-[10px]">休業</span>'),Ge=x('<span class="text-[10px] font-bold text-red-500"> </span> <span class="text-[9px] text-red-500">満員</span>',1),Je=x('<span class="text-[10px] font-medium text-slate-600 dark:text-slate-300"> </span>'),Ke=x("<div><span> </span> <span> </span> <!></div>"),Ne=x('<div class="mb-3 flex w-full items-start justify-between"><h3 class="text-primary text-lg leading-tight font-bold tracking-wide"> </h3> <div class="flex items-center gap-1"><!> <!></div></div> <div class="mb-3 grid w-full grid-cols-2 gap-2" style="--card-scale: 0.75"><!> <!></div> <div class="mb-2 w-full"><!></div> <hr class="border-default mb-3"/> <div class="grid w-full grid-cols-7 gap-1.5 p-0.5"></div>',1);function rt(ne,t){Pe(t,!0);const oe=[{classes:T.full,label:"満員"},{classes:T.targetMet,label:"目標達成"},{classes:T.belowTarget,label:"目標未達"},{classes:T.low,label:"低稼働"},{classes:T.closed,label:"休業"}];let E=B(t,"capacity",3,40),de=B(t,"targetRate",3,.9),ie=B(t,"variant",3,"default");const i=p(()=>Array.from({length:Math.ceil(t.data.length/7)},(n,c)=>t.data.slice(c*7,(c+1)*7)));let u=ae(0);Oe(()=>{e(i).length>0&&P(u,e(i).length-1)});let I=ae(!1);const ce=p(()=>e(i)[e(u)]??[]),ue=p(()=>e(u)===e(i).length-2?"lastWeek":"thisWeek");function ve(n){const c=n==="lastWeek"?e(i).length-2:e(i).length-1;P(u,Math.max(0,c),!0)}function fe(n){P(u,n,!0)}function ge(){P(I,!e(I)),!e(I)&&e(u)<e(i).length-2&&P(u,e(i).length-1)}const j=p(()=>t.data.length>0?t.data[t.data.length-1]:null),pe=p(()=>{const c=t.data.slice(-14).filter(h=>h.isOpen);return c.length===0?0:Math.round(c.reduce((h,W)=>h+W.used,0)/c.length)}),xe=p(()=>e(j)&&e(j).isOpen?`${e(j).used}/${E()}名`:"休業"),_e=p(()=>`${e(pe)}/${E()}名`);function me(n){return n.isOpen?n.used>=E()?"full":"normal":"closed"}Ae(ne,{get variant(){return ie()},get badge(){return t.badge},get devInfo(){return t.devInfo},get devContent(){return t.devContent},get onClick(){return t.onClick},tooltipText:"詳細を見る",get ariaLabel(){return t.title},class:"flex w-full flex-col items-center justify-start gap-1 p-4",interactiveClass:"interactive-card-widget",baseClass:"",children:(n,c)=>{var h=Ne(),W=O(h),L=r(W),he=r(L,!0);a(L);var Q=l(L,2),U=r(Q);De(U,{get value(){return e(ue)},onValueChange:ve});var be=l(U,2);D(be,{children:(C,v)=>{var f=Ve(),_=O(f);F(_,()=>D.Trigger,(w,m)=>{m(w,{class:"text-tertiary hover:text-primary flex items-center justify-center rounded-md p-1 transition-colors","aria-label":"凡例を表示",onclick:g=>g.stopPropagation(),children:(g,S)=>{Le(g,{size:16,strokeWidth:2})},$$slots:{default:!0}})});var b=l(_,2);Ie(b,{children:(w,m)=>{var g=re(),S=O(g);F(S,()=>D.Positioner,(V,z)=>{z(V,{children:(G,o)=>{var s=re(),k=O(s);F(k,()=>D.Content,(J,We)=>{We(J,{class:"border-default bg-card z-40 min-w-[140px] rounded-lg border p-3 shadow-lg",onclick:K=>K.stopPropagation(),children:(K,Ye)=>{var N=He(),Ce=l(r(N),2);se(Ce,17,()=>oe,Y=>Y.label,(Y,$)=>{var q=Re(),ee=r(q),te=l(ee,2),we=r(te,!0);a(te),a(q),M(()=>{A(ee,1,`inline-block h-3 w-3 rounded ${e($).classes??""}`),y(we,e($).label)}),d(Y,q)}),a(N),d(K,N)},$$slots:{default:!0}})}),d(G,s)},$$slots:{default:!0}})}),d(w,g)},$$slots:{default:!0}}),d(C,f)},$$slots:{default:!0}}),a(Q),a(W);var R=l(W,2),X=r(R);le(X,{title:"今日",get value(){return e(xe)},layout:"vertical-center"});var ke=l(X,2);le(ke,{title:"14日間平均",get value(){return e(_e)},layout:"vertical-center"}),a(R);var H=l(R,2),ye=r(H);je(ye,{get weeks(){return e(i)},get capacity(){return E()},get targetRate(){return de()},get selectedWeekIndex(){return e(u)},get expanded(){return e(I)},onWeekClick:fe,onToggleExpand:ge}),a(H);var Z=l(H,4);se(Z,21,()=>e(ce),C=>C.date,(C,v)=>{const f=p(()=>me(e(v)));var _=Ke(),b=r(_),w=r(b,!0);a(b);var m=l(b,2),g=r(m,!0);a(m);var S=l(m,2);{var V=o=>{var s=ze();d(o,s)},z=o=>{var s=Ge(),k=O(s),J=r(k);a(k),Te(2),M(()=>y(J,`${e(v).used??""}名`)),d(o,s)},G=o=>{var s=Je(),k=r(s);a(s),M(()=>y(k,`${e(v).used??""}名`)),d(o,s)};Ee(S,o=>{e(f)==="closed"?o(V):e(f)==="full"?o(z,1):o(G,!1)})}a(_),M(()=>{A(_,1,`flex flex-col items-center rounded-md p-1 ${e(f)==="closed"?"bg-surface-secondary":"bg-blue-50 dark:bg-blue-900/30"}`),A(b,1,`text-[10px] font-medium ${e(f)==="closed"?"text-tertiary":e(v).dayOfWeek===0?"text-red-500":e(v).dayOfWeek===6?"text-blue-500":"text-slate-600 dark:text-slate-400"}`),y(w,Se[e(v).dayOfWeek]),A(m,1,`text-sm font-bold ${e(f)==="closed"?"text-tertiary":"text-primary"}`),y(g,e(v).date)}),d(C,_)}),a(Z),M(()=>y(he,t.title)),d(n,h)},$$slots:{default:!0}}),Me()}export{rt as W};
