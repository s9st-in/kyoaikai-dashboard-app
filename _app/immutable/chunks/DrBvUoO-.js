import{L as f,M as w,g as r,x as n,u as y,N as F}from"./Dj_qSXc_.js";const S=[{id:"overview",label:"概要"},{id:"operations",label:"稼働"},{id:"patients",label:"外来・入院"},{id:"staff",label:"人員"},{id:"finance",label:"財務"}],h=S.map(t=>t.id),d=4,b=14,V="facility",c="overview",p=S.map(t=>t.id),I=Symbol("dashboard-context"),u=t=>t.length?t:[c],g=(t,e)=>e===t.comparisonType?{comparisonType:e}:e==="view"?{comparisonType:"view",selectedViewIds:[t.activeTab]}:{comparisonType:"facility",activeTab:t.selectedViewIds[0]??c},o=(t,e,s,l=!1)=>{if(t.includes(e)){if(t.length>1||!l)return t.filter(T=>T!==e)}else if(t.length<s)return[...t,e];return t},i={setComparisonType(t,e){return g(t,e)},toggleComparisonType(t){const e=t.comparisonType==="facility"?"view":"facility";return g(t,e)},setActiveTab(t){return{activeTab:t}},setDisplayDays(t){return{displayDays:t}},toggleFacility(t,e){return t.comparisonType==="view"?{selectedFacilityIds:o(t.selectedFacilityIds,e,d,!1)}:t.selectedFacilityIds.includes(e)?{selectedFacilityIds:o(t.selectedFacilityIds,e,d,!0)}:{selectedFacilityIds:[e]}},setSelectedFacilityIds(t){return{selectedFacilityIds:t}},toggleSelectAll(t){const e=t.facilities.map(a=>a.id),s=new Set(t.selectedFacilityIds);return{selectedFacilityIds:e.every(a=>s.has(a))?[]:e}},toggleView(t,e){return t.comparisonType==="facility"?{activeTab:e}:{selectedViewIds:o(t.selectedViewIds,e,d,!0)}},setSelectedViewIds(t){return{selectedViewIds:t}},toggleSelectAllViews(t){const e=new Set(t.selectedViewIds);return{selectedViewIds:p.every(l=>e.has(l))?u([]):p}},clearAllSelections(t){return t.comparisonType==="facility"?{selectedFacilityIds:[]}:{selectedViewIds:u([])}}};class A{#e=w();get state(){return r(this.#e)}set state(e){n(this.#e,e,!0)}#t=y(()=>{const e=new Set(this.state.selectedFacilityIds);return this.state.facilities.filter(s=>e.has(s.id))});get _selectedFacilities(){return r(this.#t)}set _selectedFacilities(e){n(this.#t,e)}#s=y(()=>{if(this.state.facilities.length===0)return!1;const e=new Set(this.state.selectedFacilityIds);return this.state.facilities.every(s=>e.has(s.id))});get _allSelected(){return r(this.#s)}set _allSelected(e){n(this.#s,e)}constructor(e){this.state=e}applyUpdate(e){Object.assign(this.state,e)}get comparisonType(){return this.state.comparisonType}get selectedFacilityIds(){return this.state.selectedFacilityIds}get activeTab(){return this.state.activeTab}get selectedViewIds(){return this.state.selectedViewIds}get displayDays(){return this.state.displayDays}get facilities(){return this.state.facilities}get selectedFacilities(){return this._selectedFacilities}get allSelected(){return this._allSelected}get sortedViewIds(){return this.state.selectedViewIds.slice().sort((e,s)=>h.indexOf(e)-h.indexOf(s))}get allViewsSelected(){const e=new Set(this.state.selectedViewIds);return p.every(s=>e.has(s))}get facilitiesSignature(){return this.state.facilities.map(e=>e.id).join(",")}get _state(){return this.state}setComparisonType(e){this.applyUpdate(i.setComparisonType(this.state,e))}toggleComparisonType(){this.applyUpdate(i.toggleComparisonType(this.state))}setActiveTab(e){this.applyUpdate(i.setActiveTab(e))}setDisplayDays(e){this.applyUpdate(i.setDisplayDays(e))}toggleFacility(e){this.applyUpdate(i.toggleFacility(this.state,e))}setSelectedFacilityIds(e){this.applyUpdate(i.setSelectedFacilityIds(e))}toggleSelectAll(){this.applyUpdate(i.toggleSelectAll(this.state))}toggleView(e){this.applyUpdate(i.toggleView(this.state,e))}setSelectedViewIds(e){this.applyUpdate(i.setSelectedViewIds(e))}toggleSelectAllViews(){this.applyUpdate(i.toggleSelectAllViews(this.state))}clearAllSelections(){this.applyUpdate(i.clearAllSelections(this.state))}setFacilities(e){this.state.facilities=e}reset(e){Object.assign(this.state,e)}}function v(t){const e=new A(t);return f(I,e),e}function _(){const t=F(I);if(!t)throw new Error("DashboardContext が未設定です。親コンポーネントで createDashboardContext() を呼び出してください。");return t}function m(t,e){return{comparisonType:V,selectedFacilityIds:[],activeTab:c,selectedViewIds:[c],displayDays:b,facilities:t,...e}}export{S as T,m as a,v as c,_ as u};
